[
  {
    "id" : "53774279-5f29-48df-9bc8-cbf25ebf6595",
    "prId" : 1154,
    "comments" : [
      {
        "id" : "e1cdbd9e-c692-4dc9-b1fe-6919ca5cff37",
        "parentId" : null,
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "Can you use https://hackage.haskell.org/package/nsis-0.3.2/docs/Development-NSIS.html#v:installIcon instead?",
        "createdAt" : "2019-05-15T12:28:37Z",
        "updatedAt" : "2019-05-15T12:48:42Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "75b561f7-efd1-45d9-815b-dd6f2f8b4bc3",
        "parentId" : "e1cdbd9e-c692-4dc9-b1fe-6919ca5cff37",
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "Ah missed that when browsing the docs, changed.",
        "createdAt" : "2019-05-15T12:32:58Z",
        "updatedAt" : "2019-05-15T12:48:42Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "88a7de57be0c47d60d5a5b30a322a5b45e97b8d3",
    "line" : null,
    "diffHunk" : "@@ -13,18 +13,28 @@ import SdkVersion\n \n main :: IO ()\n main = do\n-    [installerFile, sdkDir] <- getArgs\n-    writeFile installerFile $ nsis $ installer sdkDir\n+    [installerFile, sdkDir, logo] <- getArgs\n+    writeFile installerFile $ nsis $ installer sdkDir logo\n \n-installer :: FilePath -> Action SectionId\n-installer sdkDir = do\n-    name \"DAML SDK installer\"\n+installer :: FilePath -> FilePath -> Action SectionId\n+installer sdkDir logo = do\n+    name \"DAML SDK\"\n     outFile \"daml-sdk-installer.exe\"\n+    unsafeInjectGlobal $ \"!define MUI_ICON \\\"\" <> logo <> \"\\\"\""
  },
  {
    "id" : "bf4f6367-360b-4d99-93b1-e06c888d9914",
    "prId" : 1154,
    "comments" : [
      {
        "id" : "b1e464ca-db1c-4145-85d8-36a3dc76a62f",
        "parentId" : null,
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "I should add Welcome upstream to Pages, so we have less unsafe injection.",
        "createdAt" : "2019-05-15T12:29:02Z",
        "updatedAt" : "2019-05-15T12:48:42Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "88a7de57be0c47d60d5a5b30a322a5b45e97b8d3",
    "line" : null,
    "diffHunk" : "@@ -13,18 +13,28 @@ import SdkVersion\n \n main :: IO ()\n main = do\n-    [installerFile, sdkDir] <- getArgs\n-    writeFile installerFile $ nsis $ installer sdkDir\n+    [installerFile, sdkDir, logo] <- getArgs\n+    writeFile installerFile $ nsis $ installer sdkDir logo\n \n-installer :: FilePath -> Action SectionId\n-installer sdkDir = do\n-    name \"DAML SDK installer\"\n+installer :: FilePath -> FilePath -> Action SectionId\n+installer sdkDir logo = do\n+    name \"DAML SDK\"\n     outFile \"daml-sdk-installer.exe\"\n+    unsafeInjectGlobal $ \"!define MUI_ICON \\\"\" <> logo <> \"\\\"\"\n     requestExecutionLevel User\n+    unsafeInjectGlobal $ \"!insertmacro MUI_PAGE_WELCOME\""
  },
  {
    "id" : "5c1f5f4b-b7d2-4352-ad7e-2f7d5f644e4c",
    "prId" : 1154,
    "comments" : [
      {
        "id" : "2b48fea8-2ff4-48a3-802d-50fabc90e610",
        "parentId" : null,
        "author" : null,
        "body" : "I like the idea but I think having an easy way to nuke the existing installation and overwrite it is valuable. We don't have an `uninstall` command yet. Is it possible to turn this into a question \"do you want to overwrite existing installation?\" instead.",
        "createdAt" : "2019-05-15T12:29:09Z",
        "updatedAt" : "2019-05-15T12:48:42Z",
        "lastEditedBy" : null,
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "63670658-c9d3-4bf2-a74c-59a4e1f6438b",
        "parentId" : "2b48fea8-2ff4-48a3-802d-50fabc90e610",
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "I originally was planning to do that but got too frustrated by nsis. I‚Äôll take another look and fix it in a separate PR if I can get it to work.",
        "createdAt" : "2019-05-15T12:33:48Z",
        "updatedAt" : "2019-05-15T12:48:42Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "4e3399ba-0da8-4c8e-9128-c1703207ab85",
        "parentId" : "2b48fea8-2ff4-48a3-802d-50fabc90e610",
        "author" : null,
        "body" : ":+1:\r\n\r\nHaving said that I realize I'm not even sure if the windows installer does even nuke an existing installation? It probably should, like get.daml.com does.",
        "createdAt" : "2019-05-15T12:35:31Z",
        "updatedAt" : "2019-05-15T12:48:42Z",
        "lastEditedBy" : null,
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "0e62942a-1686-4f15-a769-09de15a8c861",
        "parentId" : "2b48fea8-2ff4-48a3-802d-50fabc90e610",
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "It doesn‚Äôt atm so this definitely doesn‚Äôt make things worse. It only gives a useful error message instead of the error popping up somewhere in the details later.",
        "createdAt" : "2019-05-15T12:37:20Z",
        "updatedAt" : "2019-05-15T12:48:42Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "255f3372-4d49-4638-aadc-e1a5c24014e3",
        "parentId" : "2b48fea8-2ff4-48a3-802d-50fabc90e610",
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "Managed to get it to work and included it in this PR. It now shows a yes/no popup. If you click yes it will remove the existing installation, if you click no it will abort.",
        "createdAt" : "2019-05-15T12:49:23Z",
        "updatedAt" : "2019-05-15T12:49:23Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "948b5f28-2655-4312-b1e3-4a8d10bbaa88",
        "parentId" : "2b48fea8-2ff4-48a3-802d-50fabc90e610",
        "author" : null,
        "body" : "Awesome! Thank you üôá‚Äç‚ôÄ ",
        "createdAt" : "2019-05-15T13:21:02Z",
        "updatedAt" : "2019-05-15T13:21:03Z",
        "lastEditedBy" : null,
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "88a7de57be0c47d60d5a5b30a322a5b45e97b8d3",
    "line" : null,
    "diffHunk" : "@@ -13,18 +13,28 @@ import SdkVersion\n \n main :: IO ()\n main = do\n-    [installerFile, sdkDir] <- getArgs\n-    writeFile installerFile $ nsis $ installer sdkDir\n+    [installerFile, sdkDir, logo] <- getArgs\n+    writeFile installerFile $ nsis $ installer sdkDir logo\n \n-installer :: FilePath -> Action SectionId\n-installer sdkDir = do\n-    name \"DAML SDK installer\"\n+installer :: FilePath -> FilePath -> Action SectionId\n+installer sdkDir logo = do\n+    name \"DAML SDK\"\n     outFile \"daml-sdk-installer.exe\"\n+    unsafeInjectGlobal $ \"!define MUI_ICON \\\"\" <> logo <> \"\\\"\"\n     requestExecutionLevel User\n+    unsafeInjectGlobal $ \"!insertmacro MUI_PAGE_WELCOME\"\n+    page InstFiles\n+    page $ Finish finishOptions\n+        { finLinkText = \"Open the DAML Quickstart guide\"\n+        , finLink = \"https://docs.daml.com/getting-started/quickstart.html\"\n+        }\n     section \"\" [] $ do\n         -- We use PLUGINSDIR as an easy way to get a temporary directory\n         -- that nsis will cleanup automatically.\n         unsafeInject \"InitPluginsDir\"\n+        iff_ (fileExists \"$APPDATA/daml\") $ do\n+            _ <- messageBox [MB_OK] \"DAML SDK is already installed. Use `daml install latest` to upgrade.\"\n+            abort \"Existing installation detected\""
  },
  {
    "id" : "3bececcf-edfc-4df9-b2fc-a02411763057",
    "prId" : 1154,
    "comments" : [
      {
        "id" : "c2f8c8ad-a1f7-4d4f-a9ef-7a294c2755b7",
        "parentId" : null,
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "I'm just adding this to nsis-0.3.3 (no need to upgrade to it though - can be a later date)",
        "createdAt" : "2019-05-15T12:51:27Z",
        "updatedAt" : "2019-05-15T12:52:01Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "88a7de57be0c47d60d5a5b30a322a5b45e97b8d3",
    "line" : 18,
    "diffHunk" : "@@ -13,18 +13,30 @@ import SdkVersion\n \n main :: IO ()\n main = do\n-    [installerFile, sdkDir] <- getArgs\n-    writeFile installerFile $ nsis $ installer sdkDir\n+    [installerFile, sdkDir, logo] <- getArgs\n+    writeFile installerFile $ nsis $ installer sdkDir logo\n \n-installer :: FilePath -> Action SectionId\n-installer sdkDir = do\n-    name \"DAML SDK installer\"\n+installer :: FilePath -> FilePath -> Action SectionId\n+installer sdkDir logo = do\n+    name \"DAML SDK\"\n     outFile \"daml-sdk-installer.exe\"\n+    installIcon (fromString logo)\n     requestExecutionLevel User\n+    unsafeInjectGlobal \"!insertmacro MUI_PAGE_WELCOME\""
  }
]