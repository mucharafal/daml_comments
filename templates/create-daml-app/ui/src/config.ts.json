[
  {
    "id" : "cc4795b7-ed66-4f1d-9b86-1950fbf5b769",
    "prId" : 6089,
    "comments" : [
      {
        "id" : "993b405a-5fa2-4e20-b5c2-efd2887c3f64",
        "parentId" : null,
        "author" : {
          "login" : "phoebe-da",
          "name" : "Phoebe",
          "avatarUrl" : "https://avatars3.githubusercontent.com/u/56260685?u=7c4b5bf89b209007d9ca00ea3cd765bbb0e88450&v=4"
        },
        "body" : "I don't think this is needed anymore as the DamlLedger context thing seems to default to where the page is running (normally `localhost::3000`) and the proxy can now be configured to work for websockets",
        "createdAt" : "2020-05-27T18:35:56Z",
        "updatedAt" : "2020-06-01T14:37:35Z",
        "lastEditedBy" : {
          "login" : "phoebe-da",
          "name" : "Phoebe",
          "avatarUrl" : "https://avatars3.githubusercontent.com/u/56260685?u=7c4b5bf89b209007d9ca00ea3cd765bbb0e88450&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "c7f71b79-0974-4327-804e-c297a4b5807b",
        "parentId" : "993b405a-5fa2-4e20-b5c2-efd2887c3f64",
        "author" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "body" : "You're absolutely correct!",
        "createdAt" : "2020-05-28T10:08:09Z",
        "updatedAt" : "2020-06-01T14:37:35Z",
        "lastEditedBy" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "cd2e983709187f9861357291492eca1c9d58ed41",
    "line" : 8,
    "diffHunk" : "@@ -26,11 +26,3 @@ export const httpBaseUrl =\n   deploymentMode === DeploymentMode.PROD_DABL\n   ? `https://api.projectdabl.com/data/${ledgerId}/`\n   : undefined;\n-\n-// Unfortunately, the development server of `create-react-app` does not proxy\n-// websockets properly. Thus, we need to bypass it and talk to the JSON API\n-// directly in development mode.\n-export const wsBaseUrl ="
  },
  {
    "id" : "66c7e00e-ca2c-4670-b1dc-927cd5ce6a27",
    "prId" : 5437,
    "comments" : [
      {
        "id" : "eeb7d1de-9ca9-4fae-b620-e1d587e3a464",
        "parentId" : null,
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "Did you test this? The documentation for `dotenv` says that you have to require and configure it via `require('dotenv').config()` see https://www.npmjs.com/package/dotenv. Iâ€™m struggling to see how the `.env` file is magically picked up otherwise.",
        "createdAt" : "2020-04-04T18:32:27Z",
        "updatedAt" : "2020-04-04T18:32:27Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "37879d5c-19c1-4dc9-8421-6a7439153d49",
        "parentId" : "eeb7d1de-9ca9-4fae-b620-e1d587e3a464",
        "author" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "body" : "I did test it, simply with a `console.log()` of the env var in the App component. The `.env` file is magically picked up, I'm not sure where it is configured but it must be somewhere in the create react app setup.",
        "createdAt" : "2020-04-04T19:43:09Z",
        "updatedAt" : "2020-04-04T19:43:10Z",
        "lastEditedBy" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "d71d0fe4-04aa-4394-91f1-ccc9cfea06ef",
        "parentId" : "eeb7d1de-9ca9-4fae-b620-e1d587e3a464",
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "Cool, thanks for confirming :+1:",
        "createdAt" : "2020-04-04T20:18:43Z",
        "updatedAt" : "2020-04-04T20:18:43Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "a6932b7d9443113f24305c0d4ebae35dbb9be603",
    "line" : 11,
    "diffHunk" : "@@ -14,10 +14,13 @@ export const deploymentMode: DeploymentMode =\n   ? DeploymentMode.PROD_DABL\n   : DeploymentMode.PROD_OTHER;\n \n-export const ledgerId =\n+// Decide the ledger ID based on the deployment mode first,\n+// then an environment variable, falling back on the sandbox ledger ID.\n+export const ledgerId: string =\n   deploymentMode === DeploymentMode.PROD_DABL\n   ? window.location.hostname.split('.')[0]\n-  : 'create-daml-app-sandbox';\n+  : process.env.REACT_APP_LEDGER_ID"
  },
  {
    "id" : "8bb4be47-707d-4e7b-beee-6426cf77a407",
    "prId" : 5437,
    "comments" : [
      {
        "id" : "404689b4-553e-4d5b-aadd-6eabfb95f657",
        "parentId" : null,
        "author" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "body" : "I don't know how the fixities of the ternary operator and `??` compare. Thus, I'd prefer to make it more explicit:\r\n```suggestion\r\n  : (process.env.REACT_APP_LEDGER_ID ?? 'create-daml-app-sandbox');\r\n```",
        "createdAt" : "2020-04-06T11:42:21Z",
        "updatedAt" : "2020-04-06T11:42:22Z",
        "lastEditedBy" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "b4119e74-608a-4b74-a8a1-6dc853b2fcd0",
        "parentId" : "404689b4-553e-4d5b-aadd-6eabfb95f657",
        "author" : {
          "login" : "anthonylusardi-da",
          "name" : null,
          "avatarUrl" : "https://avatars3.githubusercontent.com/u/59614480?u=a1e38232a15470bcbf95f10bf7293011710be3e8&v=4"
        },
        "body" : "`process.env.REACT_APP_LEDGER_ID` should never be missing, and will default to `'create-daml-app-sandbox'` as specified in `ui/.env`",
        "createdAt" : "2020-04-06T13:07:48Z",
        "updatedAt" : "2020-04-06T13:07:48Z",
        "lastEditedBy" : {
          "login" : "anthonylusardi-da",
          "name" : null,
          "avatarUrl" : "https://avatars3.githubusercontent.com/u/59614480?u=a1e38232a15470bcbf95f10bf7293011710be3e8&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "aa75a5c2-6874-47b4-bd66-da7e73b0855b",
        "parentId" : "404689b4-553e-4d5b-aadd-6eabfb95f657",
        "author" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "body" : "Why would you add the `??` clause in the first place then? If we add it, and I think we should, let's please make explicit where we add the default.",
        "createdAt" : "2020-04-07T09:17:18Z",
        "updatedAt" : "2020-04-07T09:17:18Z",
        "lastEditedBy" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "a6932b7d9443113f24305c0d4ebae35dbb9be603",
    "line" : 12,
    "diffHunk" : "@@ -14,10 +14,13 @@ export const deploymentMode: DeploymentMode =\n   ? DeploymentMode.PROD_DABL\n   : DeploymentMode.PROD_OTHER;\n \n-export const ledgerId =\n+// Decide the ledger ID based on the deployment mode first,\n+// then an environment variable, falling back on the sandbox ledger ID.\n+export const ledgerId: string =\n   deploymentMode === DeploymentMode.PROD_DABL\n   ? window.location.hostname.split('.')[0]\n-  : 'create-daml-app-sandbox';\n+  : process.env.REACT_APP_LEDGER_ID\n+  ?? 'create-daml-app-sandbox';"
  }
]