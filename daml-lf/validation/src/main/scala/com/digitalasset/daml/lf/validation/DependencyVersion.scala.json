[
  {
    "id" : "e1e37428-9aca-439a-8230-35decfe04bf7",
    "prId" : 7577,
    "comments" : [
      {
        "id" : "4d640fe8-487f-4897-b0b6-7f6e7a6267b5",
        "parentId" : null,
        "author" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "body" : "Are we looking up an interface or a signature here?",
        "createdAt" : "2020-10-09T11:49:56Z",
        "updatedAt" : "2020-10-12T12:30:48Z",
        "lastEditedBy" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "c37ff49b-7033-4ec1-96a9-824c167f0320",
        "parentId" : "4d640fe8-487f-4897-b0b6-7f6e7a6267b5",
        "author" : {
          "login" : "remyhaemmerle-da",
          "name" : "Remy",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/45566104?u=10d0caf8150a686217852f90e91314a4de3239a9&v=4"
        },
        "body" : "I reverted to `lookupPackage`. It is either a `Package` or a `PackageSignature`, definitively not a `PackageInterface`.",
        "createdAt" : "2020-10-12T12:19:23Z",
        "updatedAt" : "2020-10-12T12:30:48Z",
        "lastEditedBy" : {
          "login" : "remyhaemmerle-da",
          "name" : "Remy",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/45566104?u=10d0caf8150a686217852f90e91314a4de3239a9&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "59e96083-0ea9-48a6-8b1b-ca128696a09f",
        "parentId" : "4d640fe8-487f-4897-b0b6-7f6e7a6267b5",
        "author" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "body" : "That's a good call. Thank you!",
        "createdAt" : "2020-10-13T10:33:59Z",
        "updatedAt" : "2020-10-13T10:33:59Z",
        "lastEditedBy" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "d6d8aeac74d12178596915f46b0e6afbe8a23966",
    "line" : null,
    "diffHunk" : "@@ -15,7 +15,7 @@ private[validation] object DependencyVersion {\n \n     for {\n       depPkgId <- pkg.directDeps\n-      depPkg = world.lookupPackage(NoContext, depPkgId)\n+      depPkg = world.lookupPackageInterface(NoContext, depPkgId)"
  },
  {
    "id" : "55296758-0e46-4f7e-b494-3a8e18fc16fb",
    "prId" : 7050,
    "comments" : [
      {
        "id" : "a06ed073-28d3-4723-a6a8-ba49c9b53873",
        "parentId" : null,
        "author" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "body" : "I don't think having these two definitions makes anything simpler. Thus, I would suggest removing them and use `mod.languageVersion` and `mod.name` directly instead.",
        "createdAt" : "2020-08-07T05:58:55Z",
        "updatedAt" : "2020-08-07T15:26:46Z",
        "lastEditedBy" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "edd5726604b0278196086666e0c0dae724cae3ff",
    "line" : null,
    "diffHunk" : "@@ -0,0 +1,40 @@\n+// Copyright (c) 2020 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.\n+// SPDX-License-Identifier: Apache-2.0\n+\n+package com.daml.lf.validation\n+\n+import com.daml.lf.data.Ref._\n+import com.daml.lf.language.Ast._\n+import com.daml.lf.transaction.VersionTimeline\n+\n+private[validation] object DependencyVersion {\n+\n+  @throws[ValidationError]\n+  def checkModule(world: World, pkgId: PackageId, mod: Module): Unit = {\n+    import VersionTimeline.Implicits._\n+\n+    val modLangVersion = mod.languageVersion\n+    val modName = mod.name"
  },
  {
    "id" : "e6f353c6-2c97-4162-88a0-ae7ac0dce85d",
    "prId" : 7050,
    "comments" : [
      {
        "id" : "b2eef9fc-579f-4185-ad07-33f55ef4a635",
        "parentId" : null,
        "author" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "body" : "Why do we care about the module name here? The LF version is per package and hence getting all the referenced package IDs should be enough, isn't it?",
        "createdAt" : "2020-08-07T06:01:21Z",
        "updatedAt" : "2020-08-07T15:26:46Z",
        "lastEditedBy" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "d7098817-869b-4ec5-afed-7bd88c960135",
        "parentId" : "b2eef9fc-579f-4185-ad07-33f55ef4a635",
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "Looking at the Scala AST, it does have the version on the module not the package. No idea why, that’s definitely not how we represent things in protobuf or on the Haskell side.\r\n\r\nMaybe let’s keep it like this for this PR and then fix that separately?",
        "createdAt" : "2020-08-07T06:33:27Z",
        "updatedAt" : "2020-08-07T15:26:46Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "edd5726604b0278196086666e0c0dae724cae3ff",
    "line" : null,
    "diffHunk" : "@@ -0,0 +1,40 @@\n+// Copyright (c) 2020 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.\n+// SPDX-License-Identifier: Apache-2.0\n+\n+package com.daml.lf.validation\n+\n+import com.daml.lf.data.Ref._\n+import com.daml.lf.language.Ast._\n+import com.daml.lf.transaction.VersionTimeline\n+\n+private[validation] object DependencyVersion {\n+\n+  @throws[ValidationError]\n+  def checkModule(world: World, pkgId: PackageId, mod: Module): Unit = {\n+    import VersionTimeline.Implicits._\n+\n+    val modLangVersion = mod.languageVersion\n+    val modName = mod.name\n+    val ctx = ContextModule(pkgId, modName)\n+\n+    val dependencies = world.idsInModule(ctx, pkgId, modName).collect {\n+      case Identifier(depPkgId, QualifiedName(depModName, _))"
  },
  {
    "id" : "b27f6490-2dc2-4548-9dd6-4aefd624775e",
    "prId" : 7050,
    "comments" : [
      {
        "id" : "06ebf604-64a3-4f09-9548-a597479cf3f4",
        "parentId" : null,
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "Note that a package can have 0 modules (and you can produce such a package with the compiler) but it still has an LF version. We really need to move the version to the package to address this properly but I’m fine with leaving that to a separate PR.",
        "createdAt" : "2020-08-07T08:30:44Z",
        "updatedAt" : "2020-08-07T15:26:46Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "a6e7c5e4-8141-4508-99be-bc107fed4913",
        "parentId" : "06ebf604-64a3-4f09-9548-a597479cf3f4",
        "author" : {
          "login" : "remyhaemmerle-da",
          "name" : "Remy",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/45566104?u=10d0caf8150a686217852f90e91314a4de3239a9&v=4"
        },
        "body" : "Let do that in the other PR. ",
        "createdAt" : "2020-08-07T08:33:34Z",
        "updatedAt" : "2020-08-07T15:26:46Z",
        "lastEditedBy" : {
          "login" : "remyhaemmerle-da",
          "name" : "Remy",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/45566104?u=10d0caf8150a686217852f90e91314a4de3239a9&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "1ca57ba8-be86-4551-bfac-f3ec62ab540b",
        "parentId" : "06ebf604-64a3-4f09-9548-a597479cf3f4",
        "author" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "body" : "I agree, let's do it in a separate PR, but let's do it right after this one. We don't want to have this state in a release.",
        "createdAt" : "2020-08-07T08:41:08Z",
        "updatedAt" : "2020-08-07T15:26:46Z",
        "lastEditedBy" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "edd5726604b0278196086666e0c0dae724cae3ff",
    "line" : 17,
    "diffHunk" : "@@ -0,0 +1,33 @@\n+// Copyright (c) 2020 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.\n+// SPDX-License-Identifier: Apache-2.0\n+\n+package com.daml.lf.validation\n+\n+import com.daml.lf.data.Ref._\n+import com.daml.lf.language.Ast._\n+import com.daml.lf.transaction.VersionTimeline\n+\n+private[validation] object DependencyVersion {\n+\n+  @throws[ValidationError]\n+  def checkPackage(world: World, pkgId: PackageId, pkg: Package): Unit = {\n+    import VersionTimeline.Implicits._\n+\n+    for {\n+      pkgFirstModule <- pkg.modules.values.take(1)"
  }
]