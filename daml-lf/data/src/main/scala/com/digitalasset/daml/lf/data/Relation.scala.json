[
  {
    "id" : "8281eaf1-151c-4bcf-9e1f-444a040ef669",
    "prId" : 4922,
    "comments" : [
      {
        "id" : "d95db838-cf13-4b0f-9fea-7760b4dbaa2d",
        "parentId" : null,
        "author" : {
          "login" : "S11001001",
          "name" : "Stephen Compall",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/219186?u=7b27ed58a578fe7d4983d1bab28c2f5608ed8739&v=4"
        },
        "body" : "```suggestion\r\n        kvs <- relation.iterator\r\n        value <- relation._2\r\n```",
        "createdAt" : "2020-03-10T15:15:55Z",
        "updatedAt" : "2020-03-10T16:36:40Z",
        "lastEditedBy" : {
          "login" : "S11001001",
          "name" : "Stephen Compall",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/219186?u=7b27ed58a578fe7d4983d1bab28c2f5608ed8739&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "2bf28762-5e6f-4b58-a773-a73067dd8d0d",
        "parentId" : "d95db838-cf13-4b0f-9fea-7760b4dbaa2d",
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "Addressed by https://github.com/digital-asset/daml/commit/7aeffe83ba2af151bac4a285ba6563889a0dde36",
        "createdAt" : "2020-03-10T16:35:58Z",
        "updatedAt" : "2020-03-10T16:37:08Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "7aeffe83ba2af151bac4a285ba6563889a0dde36",
    "line" : null,
    "diffHunk" : "@@ -35,6 +35,12 @@ object Relation {\n \n       mutMap.toMap\n     }\n+\n+    def flatten[A, B](relation: Relation[A, B]): Iterator[(A, B)] =\n+      for {\n+        key <- relation.keysIterator"
  },
  {
    "id" : "736af304-cae2-41e7-b56e-ae73e9bbebdf",
    "prId" : 4922,
    "comments" : [
      {
        "id" : "436a6d84-baff-40a1-865f-6216369a7138",
        "parentId" : null,
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "```suggestion\r\n        (key, values) <- relation.iterator\r\n        value <- values\r\n```\r\n@S11001001 What about this?",
        "createdAt" : "2020-03-10T15:18:52Z",
        "updatedAt" : "2020-03-10T16:36:40Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "72d6d943-b272-4641-8907-5a6eb4896363",
        "parentId" : "436a6d84-baff-40a1-865f-6216369a7138",
        "author" : {
          "login" : "S11001001",
          "name" : "Stephen Compall",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/219186?u=7b27ed58a578fe7d4983d1bab28c2f5608ed8739&v=4"
        },
        "body" : "Don't do that, it adds a `withFilter` call.",
        "createdAt" : "2020-03-10T15:19:44Z",
        "updatedAt" : "2020-03-10T16:36:40Z",
        "lastEditedBy" : {
          "login" : "S11001001",
          "name" : "Stephen Compall",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/219186?u=7b27ed58a578fe7d4983d1bab28c2f5608ed8739&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "743b2b2d-3a4c-4be9-a1d1-5a9a7f213e4b",
        "parentId" : "436a6d84-baff-40a1-865f-6216369a7138",
        "author" : {
          "login" : "S11001001",
          "name" : "Stephen Compall",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/219186?u=7b27ed58a578fe7d4983d1bab28c2f5608ed8739&v=4"
        },
        "body" : "Yes, even though it looks innocent. You can't even write `kvs: (A, Set[B]) <-` without it adding a `withFilter`; the only safe things are variable bindings and `_`.",
        "createdAt" : "2020-03-10T15:21:06Z",
        "updatedAt" : "2020-03-10T16:36:40Z",
        "lastEditedBy" : {
          "login" : "S11001001",
          "name" : "Stephen Compall",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/219186?u=7b27ed58a578fe7d4983d1bab28c2f5608ed8739&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "1799bf8f-a262-4f4d-aed1-c411968cfde2",
        "parentId" : "436a6d84-baff-40a1-865f-6216369a7138",
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "I thought `withFilter` is only applied if a guard is in the `for`-comprehension? Can you explain, please?",
        "createdAt" : "2020-03-10T15:38:16Z",
        "updatedAt" : "2020-03-10T16:36:40Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "2719a173-27d3-4a9a-b3ad-8afe03d6af8c",
        "parentId" : "436a6d84-baff-40a1-865f-6216369a7138",
        "author" : {
          "login" : "S11001001",
          "name" : "Stephen Compall",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/219186?u=7b27ed58a578fe7d4983d1bab28c2f5608ed8739&v=4"
        },
        "body" : "A pattern counts as a guard (passing iff the pattern matches), and anything counts as a pattern for this purpose except the two exceptions I mentioned above, inducing a `withFilter` even if they appear irrefutable.",
        "createdAt" : "2020-03-10T15:46:05Z",
        "updatedAt" : "2020-03-10T16:36:40Z",
        "lastEditedBy" : {
          "login" : "S11001001",
          "name" : "Stephen Compall",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/219186?u=7b27ed58a578fe7d4983d1bab28c2f5608ed8739&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "4e5023d7-a6d3-4001-916a-9e32d2de5f8c",
        "parentId" : "436a6d84-baff-40a1-865f-6216369a7138",
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "Sure, the only issue with the two lines above is that they don't compile. Can I call ~`._2`~ `._1` on `kvs` or are there caveats on that?",
        "createdAt" : "2020-03-10T15:48:50Z",
        "updatedAt" : "2020-03-10T16:36:40Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "c1a7eed3-1aed-42a8-b25c-cb17d14008aa",
        "parentId" : "436a6d84-baff-40a1-865f-6216369a7138",
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "I'll assume there are no further caveats.",
        "createdAt" : "2020-03-10T16:31:32Z",
        "updatedAt" : "2020-03-10T16:36:40Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "0e36e373-59ab-4fdf-bc94-31076d89b4cd",
        "parentId" : "436a6d84-baff-40a1-865f-6216369a7138",
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "Addressed by https://github.com/digital-asset/daml/commit/7aeffe83ba2af151bac4a285ba6563889a0dde36",
        "createdAt" : "2020-03-10T16:35:53Z",
        "updatedAt" : "2020-03-10T16:37:00Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "7aeffe83ba2af151bac4a285ba6563889a0dde36",
    "line" : null,
    "diffHunk" : "@@ -35,6 +35,12 @@ object Relation {\n \n       mutMap.toMap\n     }\n+\n+    def flatten[A, B](relation: Relation[A, B]): Iterator[(A, B)] =\n+      for {\n+        key <- relation.keysIterator\n+        value <- relation(key)"
  }
]