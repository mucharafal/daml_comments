[
  {
    "id" : "17fc1688-80c1-4a03-baa2-553f5ccf8862",
    "prId" : 5843,
    "comments" : [
      {
        "id" : "8f57e444-8bc9-4772-8567-b69e20ea2058",
        "parentId" : null,
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "Nit: This isnâ€™t actually true. Our KPI is for the performance of a specific codebase not this benchmark.",
        "createdAt" : "2020-05-06T06:24:20Z",
        "updatedAt" : "2020-05-06T11:05:40Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "1755b96b-0a76-4b89-991a-2e6ab43a4f0b",
        "parentId" : "8f57e444-8bc9-4772-8567-b69e20ea2058",
        "author" : {
          "login" : "garyverhaegen-da",
          "name" : "Gary Verhaegen",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/45561385?u=eb17386ea66edbd0cd449e33b2d291bf5a1b51cb&v=4"
        },
        "body" : "I guess I was assuming this benchmark had been designed to be a somewhat accurate reflexion, as it seems to be the one used to judge individual performance PRs. I'll update the wording to be more prudent.",
        "createdAt" : "2020-05-06T10:31:17Z",
        "updatedAt" : "2020-05-06T11:05:40Z",
        "lastEditedBy" : {
          "login" : "garyverhaegen-da",
          "name" : "Gary Verhaegen",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/45561385?u=eb17386ea66edbd0cd449e33b2d291bf5a1b51cb&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "e81d3082bdb9619d997db4439b42a683b7d6838c",
    "line" : null,
    "diffHunk" : "@@ -0,0 +1,33 @@\n+# Copyright (c) 2020 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.\n+# SPDX-License-Identifier: Apache-2.0\n+\n+#!/usr/bin/env bash\n+\n+set -euo pipefail\n+\n+BASELINE=$1\n+\n+measure() {\n+    local treeish=$1\n+    local out=$(mktemp -d)/out.json\n+    git checkout $treeish >&2\n+    bazel run daml-lf/scenario-interpreter:scenario-perf -- -rf json -rff $out >&2\n+    cat $out | jq '.[0].primaryMetric.score'\n+}\n+\n+main() {\n+  local current=$(git rev-parse HEAD)\n+\n+  local baseline_perf=$(measure $BASELINE)\n+  local current_perf=$(measure $current)\n+\n+  git checkout $current >&2\n+\n+  local factor=$(echo \"$current_perf / $baseline_perf\" | bc -l)\n+  local speedup=$(printf \"%.1f\" $(echo \"($factor - 1) * 100\" | bc -l))\n+  local kpi_completion=$(printf \"%.2f\" $(echo \"100 / (l(5) / l($factor))\" | bc -l))"
  },
  {
    "id" : "73902cc4-d2e9-4e25-bd7d-fe20bd8290f5",
    "prId" : 5843,
    "comments" : [
      {
        "id" : "370173fe-015c-44dd-b532-e57062073278",
        "parentId" : null,
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "Looks like we are never deleting this directory?",
        "createdAt" : "2020-05-06T06:31:54Z",
        "updatedAt" : "2020-05-06T11:05:40Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "8420562e-e81a-47ba-a510-1e8d35408f35",
        "parentId" : "370173fe-015c-44dd-b532-e57062073278",
        "author" : {
          "login" : "garyverhaegen-da",
          "name" : "Gary Verhaegen",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/45561385?u=eb17386ea66edbd0cd449e33b2d291bf5a1b51cb&v=4"
        },
        "body" : "Indeed. The job runs once a day and the one file that function writes is about 8.8kb, so I don't think it's an issue. Even taking into account the fact that the script invokes that function twice, and FS padding (on HFS+ at least), this is still consuming only 24kb in total (as machines get cleared every day, there should never be more than one set of files).",
        "createdAt" : "2020-05-06T11:01:26Z",
        "updatedAt" : "2020-05-06T11:05:40Z",
        "lastEditedBy" : {
          "login" : "garyverhaegen-da",
          "name" : "Gary Verhaegen",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/45561385?u=eb17386ea66edbd0cd449e33b2d291bf5a1b51cb&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "e81d3082bdb9619d997db4439b42a683b7d6838c",
    "line" : 12,
    "diffHunk" : "@@ -0,0 +1,33 @@\n+# Copyright (c) 2020 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.\n+# SPDX-License-Identifier: Apache-2.0\n+\n+#!/usr/bin/env bash\n+\n+set -euo pipefail\n+\n+BASELINE=$1\n+\n+measure() {\n+    local treeish=$1\n+    local out=$(mktemp -d)/out.json"
  }
]