[
  {
    "id" : "8d83ad59-be1f-4ce9-ae49-478eab142a1b",
    "prId" : 402,
    "comments" : [
      {
        "id" : "b19104dd-4ad6-4565-8971-26c5c9789607",
        "parentId" : null,
        "author" : null,
        "body" : "can you move this into a constant to give it a bit more visibility?",
        "createdAt" : "2019-04-11T15:29:13Z",
        "updatedAt" : "2019-04-12T12:09:36Z",
        "lastEditedBy" : null,
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "5b9d6b06-3eba-4660-8db4-83d3114dbc7a",
        "parentId" : "b19104dd-4ad6-4565-8971-26c5c9789607",
        "author" : {
          "login" : "flokli",
          "name" : "Florian Klink",
          "avatarUrl" : "https://avatars3.githubusercontent.com/u/183879?u=41f435d31792cbf91592f78757b981eb8e821fc6&v=4"
        },
        "body" : "fixed.",
        "createdAt" : "2019-04-11T15:59:17Z",
        "updatedAt" : "2019-04-12T12:09:36Z",
        "lastEditedBy" : {
          "login" : "flokli",
          "name" : "Florian Klink",
          "avatarUrl" : "https://avatars3.githubusercontent.com/u/183879?u=41f435d31792cbf91592f78757b981eb8e821fc6&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "809536fc935022065e7cad9738ed17a82cc58bcc",
    "line" : null,
    "diffHunk" : "@@ -0,0 +1,36 @@\n+#! /usr/bin/env nix-shell\n+#! nix-shell -i python3 .\n+# Copyright (c) 2019 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.\n+# SPDX-License-Identifier: Apache-2.0\n+#\n+# This script purges agents older than 25 hours in a given pool\n+# Pass PAT and POOL_ID as environment variables to it\n+import datetime\n+import os\n+import sys\n+\n+from azure.devops.connection import Connection\n+from msrest.authentication import BasicAuthentication\n+\n+ORGANIZATION_URL = \"https://dev.azure.com/digitalasset\"\n+PAT = os.environ[\"PAT\"]\n+POOL_ID = os.environ[\"POOL_ID\"]\n+\n+credentials = BasicAuthentication('', PAT)\n+connection = Connection(base_url=ORGANIZATION_URL, creds=credentials)\n+\n+agent_client = connection.clients_v5_1.get_task_agent_client()\n+\n+for agent in agent_client.get_agents(POOL_ID):\n+    # agents should be killed after 24 hours max\n+    cutoff_time = datetime.datetime.now(datetime.timezone.utc)\\\n+                  - datetime.timedelta(hours=25)"
  }
]