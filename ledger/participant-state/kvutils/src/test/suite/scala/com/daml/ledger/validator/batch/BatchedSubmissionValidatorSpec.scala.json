[
  {
    "id" : "07b45f66-1879-42a9-b38b-f678c527f326",
    "prId" : 7215,
    "comments" : [
      {
        "id" : "c93aaee0-fb2c-44ab-9540-60f263155ff1",
        "parentId" : null,
        "author" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "body" : "Can you refactor this into a utility method? It made sense even earlier but now with a default less (and a further parameter) it's a good moment to do so.",
        "createdAt" : "2020-08-25T11:03:35Z",
        "updatedAt" : "2020-08-25T15:02:13Z",
        "lastEditedBy" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "b7cfc4db-f2bc-43b9-a396-b062ff4585f8",
        "parentId" : "c93aaee0-fb2c-44ab-9540-60f263155ff1",
        "author" : {
          "login" : "SamirTalwar-DA",
          "name" : "Samir Talwar",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/60356447?u=f6cdfccc6ea4254bd7c212099bbac2c27a00a28c&v=4"
        },
        "body" : "Well, given this is only used for tests, I'll push it into the `apply` method and make it package-private.",
        "createdAt" : "2020-08-25T11:16:22Z",
        "updatedAt" : "2020-08-25T15:02:13Z",
        "lastEditedBy" : {
          "login" : "SamirTalwar-DA",
          "name" : "Samir Talwar",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/60356447?u=f6cdfccc6ea4254bd7c212099bbac2c27a00a28c&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "8510b97c-08f1-4f12-b3ee-945e6bc9cb61",
        "parentId" : "c93aaee0-fb2c-44ab-9540-60f263155ff1",
        "author" : {
          "login" : "SamirTalwar-DA",
          "name" : "Samir Talwar",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/60356447?u=f6cdfccc6ea4254bd7c212099bbac2c27a00a28c&v=4"
        },
        "body" : "Ended up moving this method into the test class itself and making it more useful there.",
        "createdAt" : "2020-08-25T14:28:26Z",
        "updatedAt" : "2020-08-25T15:02:13Z",
        "lastEditedBy" : {
          "login" : "SamirTalwar-DA",
          "name" : "Samir Talwar",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/60356447?u=f6cdfccc6ea4254bd7c212099bbac2c27a00a28c&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "0020dd8e089d897ae22c94ce2643c7d7f6073b04",
    "line" : 47,
    "diffHunk" : "@@ -1,1 +58,62 @@      val validator = newBatchedSubmissionValidator[Unit](\n        BatchedSubmissionValidatorParameters.reasonableDefault,\n      )\n\n      validator"
  },
  {
    "id" : "63929ccb-b9f9-431a-9c55-efeec22142fa",
    "prId" : 6004,
    "comments" : [
      {
        "id" : "2ef8394c-9171-43a5-9648-e4109cb91ef1",
        "parentId" : null,
        "author" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "body" : "Can it be made more precise?",
        "createdAt" : "2020-05-22T16:37:04Z",
        "updatedAt" : "2020-05-25T16:06:53Z",
        "lastEditedBy" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "db0c43e6-f0ad-43bc-b80d-cc2b5802a583",
        "parentId" : "2ef8394c-9171-43a5-9648-e4109cb91ef1",
        "author" : {
          "login" : "miklos-da",
          "name" : "Miklos",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/57664299?v=4"
        },
        "body" : "We don't really care about the exact failure message here.",
        "createdAt" : "2020-05-25T10:15:38Z",
        "updatedAt" : "2020-05-25T16:06:53Z",
        "lastEditedBy" : {
          "login" : "miklos-da",
          "name" : "Miklos",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/57664299?v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "f5039a2c00da681659f3cc8423f9ddfc9d993996",
    "line" : 58,
    "diffHunk" : "@@ -1,1 +56,60 @@        .failed\n        .map { result =>\n          result shouldBe a[ValidationFailed]\n        }\n    }"
  },
  {
    "id" : "1df4b846-5a84-4055-84b6-3de1b190a97d",
    "prId" : 6004,
    "comments" : [
      {
        "id" : "dec842a6-0f59-419d-b3cd-c78b1126c00c",
        "parentId" : null,
        "author" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "body" : "Can it be made more precise?",
        "createdAt" : "2020-05-22T16:37:17Z",
        "updatedAt" : "2020-05-25T16:06:53Z",
        "lastEditedBy" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "3654bfa6-0a63-4f0f-b5e9-4943c3d83fad",
        "parentId" : "dec842a6-0f59-419d-b3cd-c78b1126c00c",
        "author" : {
          "login" : "miklos-da",
          "name" : "Miklos",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/57664299?v=4"
        },
        "body" : "We don't really care about the exact failure message here.",
        "createdAt" : "2020-05-25T10:16:02Z",
        "updatedAt" : "2020-05-25T16:06:53Z",
        "lastEditedBy" : {
          "login" : "miklos-da",
          "name" : "Miklos",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/57664299?v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "f5039a2c00da681659f3cc8423f9ddfc9d993996",
    "line" : 80,
    "diffHunk" : "@@ -1,1 +78,82 @@        .failed\n        .map { result =>\n          result shouldBe a[ValidationFailed]\n        }\n    }"
  },
  {
    "id" : "a44f8c54-bd20-4649-91ec-a0eddc1956c7",
    "prId" : 6004,
    "comments" : [
      {
        "id" : "bb4a815d-b8b7-47b3-9555-861279118a1f",
        "parentId" : null,
        "author" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "body" : "Can it be made more precise?",
        "createdAt" : "2020-05-22T16:37:33Z",
        "updatedAt" : "2020-05-25T16:06:53Z",
        "lastEditedBy" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "d0edf47e-32de-4788-8ba4-179c080b020c",
        "parentId" : "bb4a815d-b8b7-47b3-9555-861279118a1f",
        "author" : {
          "login" : "miklos-da",
          "name" : "Miklos",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/57664299?v=4"
        },
        "body" : "We don't really care about the exact failure message here.",
        "createdAt" : "2020-05-25T10:16:50Z",
        "updatedAt" : "2020-05-25T16:06:53Z",
        "lastEditedBy" : {
          "login" : "miklos-da",
          "name" : "Miklos",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/57664299?v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "f5039a2c00da681659f3cc8423f9ddfc9d993996",
    "line" : 107,
    "diffHunk" : "@@ -1,1 +105,109 @@        .failed\n        .map { result =>\n          result shouldBe a[ValidationFailed]\n        }\n    }"
  },
  {
    "id" : "cfbe13c3-02d7-4f06-b93d-a34894209201",
    "prId" : 6004,
    "comments" : [
      {
        "id" : "62f03200-f421-452a-8fb2-61b5cf3d4e6a",
        "parentId" : null,
        "author" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "body" : "How about the value set?",
        "createdAt" : "2020-05-22T16:38:48Z",
        "updatedAt" : "2020-05-25T16:06:53Z",
        "lastEditedBy" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "b26a3f2f-99c8-4ce2-b46c-ecafc9c3892b",
        "parentId" : "62f03200-f421-452a-8fb2-61b5cf3d4e6a",
        "author" : {
          "login" : "miklos-da",
          "name" : "Miklos",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/57664299?v=4"
        },
        "body" : "That's an implementation detail of `KeyValueCommitting` that shouldn't be tested here.",
        "createdAt" : "2020-05-25T10:18:43Z",
        "updatedAt" : "2020-05-25T16:06:53Z",
        "lastEditedBy" : {
          "login" : "miklos-da",
          "name" : "Miklos",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/57664299?v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "f5039a2c00da681659f3cc8423f9ddfc9d993996",
    "line" : 154,
    "diffHunk" : "@@ -1,1 +152,156 @@            outputStateCaptor.getValue.asInstanceOf[Map[DamlStateKey, DamlStateValue]]\n          outputState should have size 2\n          outputState.keySet should be(partySubmission.getInputDamlStateList.asScala.toSet)\n        }\n    }"
  },
  {
    "id" : "9e025855-dedb-42fd-96ad-350a52fa06dd",
    "prId" : 6004,
    "comments" : [
      {
        "id" : "f39da9eb-a5e7-4057-8753-26a671029f5d",
        "parentId" : null,
        "author" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "body" : "Aren't there more cases to be tested?",
        "createdAt" : "2020-05-22T16:39:47Z",
        "updatedAt" : "2020-05-25T16:06:53Z",
        "lastEditedBy" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "0cfd22af-2eab-4a46-b3f3-2c112c4c8448",
        "parentId" : "f39da9eb-a5e7-4057-8753-26a671029f5d",
        "author" : {
          "login" : "miklos-da",
          "name" : "Miklos",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/57664299?v=4"
        },
        "body" : "I see diminishing returns with more tests here but let me know if you have specific suggestions.",
        "createdAt" : "2020-05-25T10:20:15Z",
        "updatedAt" : "2020-05-25T16:06:53Z",
        "lastEditedBy" : {
          "login" : "miklos-da",
          "name" : "Miklos",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/57664299?v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "62266f92-baf0-417f-a2aa-dcee4954f2bb",
        "parentId" : "f39da9eb-a5e7-4057-8753-26a671029f5d",
        "author" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "body" : "I was mostly thinking about less submissions than committers.",
        "createdAt" : "2020-05-25T12:14:57Z",
        "updatedAt" : "2020-05-25T16:06:53Z",
        "lastEditedBy" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "184fc34b-12f5-430d-aeaf-94a6b1c94019",
        "parentId" : "f39da9eb-a5e7-4057-8753-26a671029f5d",
        "author" : {
          "login" : "miklos-da",
          "name" : "Miklos",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/57664299?v=4"
        },
        "body" : "In that case we won't be using some of the committer threads. We would be testing akka instead of our logic. The other test cases make sure certain edge cases work that we need to rely on.",
        "createdAt" : "2020-05-25T13:43:44Z",
        "updatedAt" : "2020-05-25T16:06:53Z",
        "lastEditedBy" : {
          "login" : "miklos-da",
          "name" : "Miklos",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/57664299?v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "f5039a2c00da681659f3cc8423f9ddfc9d993996",
    "line" : 162,
    "diffHunk" : "@@ -1,1 +160,164 @@    }\n\n    \"validate a batch with 1 committer for each submission\" in {\n      validateBatchSubmission(nSubmissions = 4, commitParallelism = 4)\n    }"
  },
  {
    "id" : "484f5f02-3dd8-4b32-90ea-e4d339d48f9e",
    "prId" : 6004,
    "comments" : [
      {
        "id" : "d9b54e8b-c577-4a3b-a2ff-3ad4a02ad6f2",
        "parentId" : null,
        "author" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "body" : "Wouldn't 2 be enough?",
        "createdAt" : "2020-05-22T16:40:25Z",
        "updatedAt" : "2020-05-25T16:06:53Z",
        "lastEditedBy" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "e50ed678-4a35-4e09-aff7-ef47d00b99a0",
        "parentId" : "d9b54e8b-c577-4a3b-a2ff-3ad4a02ad6f2",
        "author" : {
          "login" : "miklos-da",
          "name" : "Miklos",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/57664299?v=4"
        },
        "body" : "You have a very small chance of getting 100 submissions committed in the right order unless you actually follow the contract (i.e., commit them explicitly in the order you received them). With 2 submissions a randomized order may end up to be right half the time.",
        "createdAt" : "2020-05-25T10:23:53Z",
        "updatedAt" : "2020-05-25T16:06:53Z",
        "lastEditedBy" : {
          "login" : "miklos-da",
          "name" : "Miklos",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/57664299?v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "0b252a33-35b4-47c5-afe8-4d18a404bd98",
        "parentId" : "d9b54e8b-c577-4a3b-a2ff-3ad4a02ad6f2",
        "author" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "body" : "Unless you produce them in the wrong order.",
        "createdAt" : "2020-05-25T12:16:30Z",
        "updatedAt" : "2020-05-25T16:06:53Z",
        "lastEditedBy" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "f5039a2c00da681659f3cc8423f9ddfc9d993996",
    "line" : 167,
    "diffHunk" : "@@ -1,1 +165,169 @@\n    \"serially commit a batch in case commitParallelism is set to 1\" in {\n      val nSubmissions = 100\n      val (submissions, _, batchSubmissionBytes) = createBatchSubmissionOf(nSubmissions)\n      val mockLedgerStateReader = mock[DamlLedgerStateReader]"
  },
  {
    "id" : "a976a9cb-8bba-4b02-aef0-a3c4184151ba",
    "prId" : 6004,
    "comments" : [
      {
        "id" : "30195482-36fa-42c5-a957-ada5dfb1f841",
        "parentId" : null,
        "author" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "body" : "How about the values?",
        "createdAt" : "2020-05-22T16:47:11Z",
        "updatedAt" : "2020-05-25T16:06:53Z",
        "lastEditedBy" : {
          "login" : "fabiotudone-da",
          "name" : null,
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/59609563?u=a3a8ac844c9aacd1d1bd319a77d1d0ac60d701a3&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "707e1768-2e3f-4883-8e1b-0339a56ab04e",
        "parentId" : "30195482-36fa-42c5-a957-ada5dfb1f841",
        "author" : {
          "login" : "miklos-da",
          "name" : "Miklos",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/57664299?v=4"
        },
        "body" : "See https://github.com/digital-asset/daml/pull/6004#discussion_r429857249",
        "createdAt" : "2020-05-25T10:24:59Z",
        "updatedAt" : "2020-05-25T16:06:53Z",
        "lastEditedBy" : {
          "login" : "miklos-da",
          "name" : "Miklos",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/57664299?v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "f5039a2c00da681659f3cc8423f9ddfc9d993996",
    "line" : 370,
    "diffHunk" : "@@ -1,1 +368,372 @@          .fold(Map.empty) { case (a, b) => a ++ b }\n        outputState should have size (2 * nSubmissions.toLong) // party + submission dedup for each\n        outputState.keySet should be(submissions.flatMap(_.getInputDamlStateList.asScala).toSet)\n      }\n  }"
  }
]