[
  {
    "id" : "045243ea-60ad-4a27-ac05-7163c6462c00",
    "prId" : 7127,
    "comments" : [
      {
        "id" : "4c00be84-77d1-4fe7-bf27-6d91e6f18ad8",
        "parentId" : null,
        "author" : {
          "login" : "remyhaemmerle-da",
          "name" : "Remy",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/45566104?u=10d0caf8150a686217852f90e91314a4de3239a9&v=4"
        },
        "body" : "@SamirTalwar-DA what do you think about that ? ",
        "createdAt" : "2020-08-13T15:22:09Z",
        "updatedAt" : "2020-08-13T19:45:44Z",
        "lastEditedBy" : {
          "login" : "remyhaemmerle-da",
          "name" : "Remy",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/45566104?u=10d0caf8150a686217852f90e91314a4de3239a9&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "92d82977-4764-4609-a7ef-75cc57abbbbe",
        "parentId" : "4c00be84-77d1-4fe7-bf27-6d91e6f18ad8",
        "author" : {
          "login" : "SamirTalwar-DA",
          "name" : "Samir Talwar",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/60356447?u=f6cdfccc6ea4254bd7c212099bbac2c27a00a28c&v=4"
        },
        "body" : "Looks good to me. ðŸ˜€ ",
        "createdAt" : "2020-08-13T15:34:22Z",
        "updatedAt" : "2020-08-13T19:45:44Z",
        "lastEditedBy" : {
          "login" : "SamirTalwar-DA",
          "name" : "Samir Talwar",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/60356447?u=f6cdfccc6ea4254bd7c212099bbac2c27a00a28c&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "e82a6b71607763a9604804e8eccd1345e7ab4616",
    "line" : 22,
    "diffHunk" : "@@ -63,14 +63,19 @@ object SandboxServer {\n \n   private val logger = ContextualizedLogger.get(this.getClass)\n \n-  // FIXME: https://github.com/digital-asset/daml/issues/5164\n-  // This should be made configurable\n-  @silent(\"Sandbox_Classic in object EngineConfig is deprecated\")\n-  private[sandbox] val engineConfig: EngineConfig = EngineConfig.Sandbox_Classic\n-\n   // We memoize the engine between resets so we avoid the expensive\n   // repeated validation of the sames packages after each reset\n-  private val engine = new Engine(engineConfig)\n+  private[this] var engine: Option[Engine] = None\n+\n+  private def getEngine(config: EngineConfig): Engine = synchronized {\n+    engine match {\n+      case Some(eng) if eng.config == config => eng\n+      case _ =>\n+        val eng = new Engine(config)\n+        engine = Some(eng)\n+        eng\n+    }\n+  }"
  },
  {
    "id" : "5dda6840-c3a5-45b8-bfda-f697f523ee2f",
    "prId" : 7122,
    "comments" : [
      {
        "id" : "a322ba33-5d7a-4df3-b74c-343367591c8f",
        "parentId" : null,
        "author" : {
          "login" : "SamirTalwar-DA",
          "name" : "Samir Talwar",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/60356447?u=f6cdfccc6ea4254bd7c212099bbac2c27a00a28c&v=4"
        },
        "body" : "So if this is called twice with different configs, it will just return an engine configured wrongly?\r\n\r\nAs the `config` will always be the same, perhaps just store it in a variable outside?",
        "createdAt" : "2020-08-13T15:05:33Z",
        "updatedAt" : "2020-08-14T13:13:49Z",
        "lastEditedBy" : {
          "login" : "SamirTalwar-DA",
          "name" : "Samir Talwar",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/60356447?u=f6cdfccc6ea4254bd7c212099bbac2c27a00a28c&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "5a4fb24b-977e-4177-b36f-0e426ddc1b5d",
        "parentId" : "a322ba33-5d7a-4df3-b74c-343367591c8f",
        "author" : {
          "login" : "remyhaemmerle-da",
          "name" : "Remy",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/45566104?u=10d0caf8150a686217852f90e91314a4de3239a9&v=4"
        },
        "body" : "Let's solve this issue in  #7127",
        "createdAt" : "2020-08-13T15:10:52Z",
        "updatedAt" : "2020-08-14T13:13:49Z",
        "lastEditedBy" : {
          "login" : "remyhaemmerle-da",
          "name" : "Remy",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/45566104?u=10d0caf8150a686217852f90e91314a4de3239a9&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "00c2ee3104d175973633f88a402a4b6ebe11f178",
    "line" : null,
    "diffHunk" : "@@ -70,7 +70,15 @@ object SandboxServer {\n \n   // We memoize the engine between resets so we avoid the expensive\n   // repeated validation of the sames packages after each reset\n-  private val engine = new Engine(engineConfig)\n+  private[this] var engine: Option[Engine] = None\n+\n+  private def getEngine(config: EngineConfig): Engine = synchronized {\n+    engine.getOrElse {\n+      val engine = new Engine(config)"
  }
]