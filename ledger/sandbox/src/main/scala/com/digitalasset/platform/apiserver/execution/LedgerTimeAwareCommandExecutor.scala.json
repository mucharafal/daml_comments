[
  {
    "id" : "56d93497-6e04-45aa-a888-cd8bdf83799e",
    "prId" : 5541,
    "comments" : [
      {
        "id" : "d5bb701e-97a0-4b45-af2a-5996c6e735d4",
        "parentId" : null,
        "author" : {
          "login" : "SamirTalwar-DA",
          "name" : "Samir Talwar",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/60356447?u=f6cdfccc6ea4254bd7c212099bbac2c27a00a28c&v=4"
        },
        "body" : "```suggestion\r\n  // Does nothing if `newTime` is empty. This can happen if the transaction only regarded divulged contracts.\r\n```",
        "createdAt" : "2020-04-15T12:34:59Z",
        "updatedAt" : "2020-04-17T19:02:12Z",
        "lastEditedBy" : {
          "login" : "SamirTalwar-DA",
          "name" : "Samir Talwar",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/60356447?u=f6cdfccc6ea4254bd7c212099bbac2c27a00a28c&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "43695e5a-ad54-46fd-a0c0-c470a07f8bc0",
        "parentId" : "d5bb701e-97a0-4b45-af2a-5996c6e735d4",
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "I thought I fixed this, thanks.",
        "createdAt" : "2020-04-15T12:54:33Z",
        "updatedAt" : "2020-04-17T19:02:12Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "72a30c67-0032-4d97-b8c9-45c4d9689e77",
        "parentId" : "d5bb701e-97a0-4b45-af2a-5996c6e735d4",
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "Uh, it was just committed locally. :sweat_smile: But good catch, thanks for reading the comments.",
        "createdAt" : "2020-04-15T12:56:39Z",
        "updatedAt" : "2020-04-17T19:02:12Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "a15b08e0-d2d1-4bf4-bfb7-691c7a3ace77",
        "parentId" : "d5bb701e-97a0-4b45-af2a-5996c6e735d4",
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "Addressed by https://github.com/digital-asset/daml/pull/5541/commits/abfc4cf353d52e71cce74396ea958554f7f06b30",
        "createdAt" : "2020-04-15T12:59:24Z",
        "updatedAt" : "2020-04-17T19:02:12Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "2034352017063fbc2c958c5a086273e66ed0ad47",
    "line" : null,
    "diffHunk" : "@@ -95,16 +95,19 @@ final class LedgerTimeAwareCommandExecutor(\n       }\n   }\n \n+  // Does nothing if `t` is empty. This can happen if the transaction only regarded divulged contracts."
  },
  {
    "id" : "457cf43c-873f-454b-bafa-fd2eb48ebd3e",
    "prId" : 5541,
    "comments" : [
      {
        "id" : "881ad07a-9b93-4f79-9103-4a637a7b3162",
        "parentId" : null,
        "author" : {
          "login" : "SamirTalwar-DA",
          "name" : "Samir Talwar",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/60356447?u=f6cdfccc6ea4254bd7c212099bbac2c27a00a28c&v=4"
        },
        "body" : "```suggestion\r\n  // Does nothing if `newTime` is empty. This can happen if the transaction only regarded divulged contracts.\r\n```",
        "createdAt" : "2020-04-15T12:35:19Z",
        "updatedAt" : "2020-04-17T19:02:12Z",
        "lastEditedBy" : {
          "login" : "SamirTalwar-DA",
          "name" : "Samir Talwar",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/60356447?u=f6cdfccc6ea4254bd7c212099bbac2c27a00a28c&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "5df4ab16-f1d6-410c-9e60-fc982f235c41",
        "parentId" : "881ad07a-9b93-4f79-9103-4a637a7b3162",
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "Why `can`?",
        "createdAt" : "2020-04-15T12:50:35Z",
        "updatedAt" : "2020-04-17T19:02:12Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "24d63839-4c1e-4f29-bed0-71a977e5394a",
        "parentId" : "881ad07a-9b93-4f79-9103-4a637a7b3162",
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "Oh, it's in the other comment. That's the wrong one. :wink: ",
        "createdAt" : "2020-04-15T12:54:18Z",
        "updatedAt" : "2020-04-17T19:02:12Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "d43d8cdc-f80f-4f77-ae05-b08bc8af868d",
        "parentId" : "881ad07a-9b93-4f79-9103-4a637a7b3162",
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "Addressed by https://github.com/digital-asset/daml/pull/5541/commits/abfc4cf353d52e71cce74396ea958554f7f06b30",
        "createdAt" : "2020-04-15T12:59:31Z",
        "updatedAt" : "2020-04-17T19:02:12Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "2034352017063fbc2c958c5a086273e66ed0ad47",
    "line" : null,
    "diffHunk" : "@@ -95,16 +95,19 @@ final class LedgerTimeAwareCommandExecutor(\n       }\n   }\n \n+  // Does nothing if `t` is empty. This can happen if the transaction only regarded divulged contracts.\n   private[this] def advanceOutputTime(\n       res: CommandExecutionResult,\n-      t: Instant\n+      newTime: Option[Instant],\n   ): CommandExecutionResult =\n-    res.copy(\n-      transactionMeta =\n-        res.transactionMeta.copy(ledgerEffectiveTime = Time.Timestamp.assertFromInstant(t)))\n+    newTime.fold(res)(\n+      t =>\n+        res.copy(transactionMeta =\n+          res.transactionMeta.copy(ledgerEffectiveTime = Time.Timestamp.assertFromInstant(t))))\n \n-  private[this] def advanceInputTime(cmd: Commands, t: Instant): Commands =\n-    cmd.copy(ledgerEffectiveTime = t)\n+  // Does nothing if `t` is empty. This happens if the transaction only regarded divulged contracts."
  },
  {
    "id" : "2cdd33a1-2bdd-45df-928c-036af3d5f153",
    "prId" : 5541,
    "comments" : [
      {
        "id" : "9ea5a1c8-57dc-444c-ad5a-a5e0cbad8328",
        "parentId" : null,
        "author" : {
          "login" : "gerolf-da",
          "name" : "Gerolf Seitz",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/29121423?u=f683aa614e742c653ae8c01b194905dcdef6e974&v=4"
        },
        "body" : "```suggestion\r\n                if (!maxUsedTime.forAll(_.isAfter(commands.ledgerEffectiveTime))) {\r\n```",
        "createdAt" : "2020-04-16T07:19:29Z",
        "updatedAt" : "2020-04-17T19:02:12Z",
        "lastEditedBy" : {
          "login" : "gerolf-da",
          "name" : "Gerolf Seitz",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/29121423?u=f683aa614e742c653ae8c01b194905dcdef6e974&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "1419fef9-d322-4b57-9e01-3bc397eb9909",
        "parentId" : "9ea5a1c8-57dc-444c-ad5a-a5e0cbad8328",
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "Ha! I always forget the combinators, thanks!",
        "createdAt" : "2020-04-16T08:59:55Z",
        "updatedAt" : "2020-04-17T19:02:12Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "2034352017063fbc2c958c5a086273e66ed0ad47",
    "line" : null,
    "diffHunk" : "@@ -70,7 +70,7 @@ final class LedgerTimeAwareCommandExecutor(\n             contractStore\n               .lookupMaximumLedgerTime(usedContractIds)\n               .flatMap(maxUsedTime =>\n-                if (!maxUsedTime.isAfter(commands.ledgerEffectiveTime)) {\n+                if (!maxUsedTime.fold(true)(_.isAfter(commands.ledgerEffectiveTime))) {"
  },
  {
    "id" : "bda60140-56e4-48bb-bfa6-8a8578a96434",
    "prId" : 5541,
    "comments" : [
      {
        "id" : "98ed973c-9c6d-4b09-a931-12af4a29add2",
        "parentId" : null,
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "```suggestion\r\n                if (!maxUsedTime.forall(_.isAfter(commands.ledgerEffectiveTime))) {\r\n```\r\nFix compilation error.",
        "createdAt" : "2020-04-16T18:36:54Z",
        "updatedAt" : "2020-04-17T19:02:12Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "2034352017063fbc2c958c5a086273e66ed0ad47",
    "line" : null,
    "diffHunk" : "@@ -70,7 +70,7 @@ final class LedgerTimeAwareCommandExecutor(\n             contractStore\n               .lookupMaximumLedgerTime(usedContractIds)\n               .flatMap(maxUsedTime =>\n-                if (!maxUsedTime.isAfter(commands.ledgerEffectiveTime)) {\n+                if (!maxUsedTime.forAll(_.isAfter(commands.ledgerEffectiveTime))) {"
  }
]