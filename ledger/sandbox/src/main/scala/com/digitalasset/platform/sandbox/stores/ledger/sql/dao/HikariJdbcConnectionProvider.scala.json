[
  {
    "id" : "b243e25d-0632-4800-869b-0c2e583fe4ef",
    "prId" : 3655,
    "comments" : [
      {
        "id" : "ec1f53fe-4dfd-41d6-80b6-76d792c3246d",
        "parentId" : null,
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "Thanks for spotting this unused code. :bowing_man: ",
        "createdAt" : "2019-11-28T12:28:55Z",
        "updatedAt" : "2019-11-29T13:33:04Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "6faa9af0e976c271138c3d4af75a805e9497ba39",
    "line" : 5,
    "diffHunk" : "@@ -97,11 +97,3 @@ class HikariJdbcConnectionProvider(\n     streamingDataSource.close()\n   }\n }\n-\n-object HikariJdbcConnectionProvider {"
  },
  {
    "id" : "e6749823-2d68-4294-b478-a480c9923634",
    "prId" : 3417,
    "comments" : [
      {
        "id" : "86958b6f-5a80-4c88-a29a-d7fb146eb961",
        "parentId" : null,
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "Since this is a `trait` it could make sense to have this.",
        "createdAt" : "2019-11-11T15:42:09Z",
        "updatedAt" : "2019-11-11T17:19:08Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "f76f496a9acb7aa099941cafa8af15182d2da731",
    "line" : null,
    "diffHunk" : "@@ -20,7 +20,7 @@ trait JdbcConnectionProvider extends AutoCloseable {\n   def runSQL[T](block: Connection => T): T\n \n   /** Returns a connection meant to be used for long running streaming queries. The Connection has to be closed manually! */\n-  def getStreamingConnection(): Connection\n+  def getStreamingConnection: Connection"
  },
  {
    "id" : "3a71d0f1-d945-4a46-80ee-9bdb6438e110",
    "prId" : 3417,
    "comments" : [
      {
        "id" : "e32db0c1-5307-4ec1-9f38-6b40955bdcf6",
        "parentId" : null,
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "If this method is side-effecting, it's probably better to keep this (you can override a `def` without arguments with a `def`  with an empty tuple of arguments).",
        "createdAt" : "2019-11-11T15:43:06Z",
        "updatedAt" : "2019-11-11T17:19:08Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "f76f496a9acb7aa099941cafa8af15182d2da731",
    "line" : null,
    "diffHunk" : "@@ -89,7 +89,7 @@ class HikariJdbcConnectionProvider(\n     }\n   }\n \n-  override def getStreamingConnection(): Connection =\n+  override def getStreamingConnection: Connection ="
  },
  {
    "id" : "2ac7c86d-7b21-4484-a70e-807ca57a800c",
    "prId" : 3359,
    "comments" : [
      {
        "id" : "e37c8a94-3450-4d16-8e82-d342992c4f06",
        "parentId" : null,
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "This spreads the logging concern across two classes, I'm not sure we should do this.",
        "createdAt" : "2019-11-06T14:25:36Z",
        "updatedAt" : "2019-11-07T14:26:30Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "a8de460d-6d40-42ff-bf18-084f38cea8c4",
        "parentId" : "e37c8a94-3450-4d16-8e82-d342992c4f06",
        "author" : {
          "login" : "oliverse-da",
          "name" : "Oliver Seeliger",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/46452754?u=dd1d8e09760abe67b40a4e527a15aafe9d104d82&v=4"
        },
        "body" : "Agreed this looks strange.",
        "createdAt" : "2019-11-06T15:01:29Z",
        "updatedAt" : "2019-11-07T14:26:30Z",
        "lastEditedBy" : {
          "login" : "oliverse-da",
          "name" : "Oliver Seeliger",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/46452754?u=dd1d8e09760abe67b40a4e527a15aafe9d104d82&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "3ae96b97-315d-4aa5-bb84-92ee2ac8a95d",
        "parentId" : "e37c8a94-3450-4d16-8e82-d342992c4f06",
        "author" : {
          "login" : "gerolf-da",
          "name" : "Gerolf Seitz",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/29121423?u=f683aa614e742c653ae8c01b194905dcdef6e974&v=4"
        },
        "body" : "why do we need it here as well?",
        "createdAt" : "2019-11-06T18:07:41Z",
        "updatedAt" : "2019-11-07T14:26:30Z",
        "lastEditedBy" : {
          "login" : "gerolf-da",
          "name" : "Gerolf Seitz",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/29121423?u=f683aa614e742c653ae8c01b194905dcdef6e974&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "41d3fe68-e309-4c6e-8920-1900c0cd915d",
        "parentId" : "e37c8a94-3450-4d16-8e82-d342992c4f06",
        "author" : {
          "login" : "oliverse-da",
          "name" : "Oliver Seeliger",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/46452754?u=dd1d8e09760abe67b40a4e527a15aafe9d104d82&v=4"
        },
        "body" : "The original intent was for errors, i.e. [in the HikariJdbcConnectionProvider where errors are caught](https://github.com/digital-asset/daml/blob/master/ledger/sandbox/src/main/scala/com/digitalasset/platform/sandbox/stores/ledger/sql/dao/HikariJdbcConnectionProvider.scala#L87-L89) to log the sql description as well, not just regular sql trace [in the SqlExecutor](https://github.com/digital-asset/daml/blob/master/ledger/sandbox/src/main/scala/com/digitalasset/platform/sandbox/stores/ledger/sql/util/SqlExecutor.scala#L43-L44). This helps in regular production in which trace is off, but errors are logged.",
        "createdAt" : "2019-11-07T08:03:50Z",
        "updatedAt" : "2019-11-07T14:26:30Z",
        "lastEditedBy" : {
          "login" : "oliverse-da",
          "name" : "Oliver Seeliger",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/46452754?u=dd1d8e09760abe67b40a4e527a15aafe9d104d82&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "57b56f34c1c450872c0e56b48c140c1fe8a5ccab",
    "line" : null,
    "diffHunk" : "@@ -18,7 +18,7 @@ trait JdbcConnectionProvider extends AutoCloseable {\n     * is returned to the pool.\n     * The block must not recursively call [[runSQL]], as this could result in a deadlock\n     * waiting for a free connection from the same pool. */\n-  def runSQL[T](block: Connection => T): T\n+  def runSQL[T](description: String, block: Connection => T): T"
  },
  {
    "id" : "da3fd582-1766-472b-bb32-30249bfab7a9",
    "prId" : 3359,
    "comments" : [
      {
        "id" : "f335fc51-02ee-4249-bb67-cf3c2ce911c1",
        "parentId" : null,
        "author" : {
          "login" : "SamirTalwar",
          "name" : "Samir Talwar",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/47582?v=4"
        },
        "body" : "Perhaps `runSQL[T](description: String)(block: Connection => T): T`?\r\n\r\nThis way it can be called like this:\r\n\r\n```scala\r\nrunSQL(\"some description\") { connection =>\r\n  ...\r\n}\r\n```",
        "createdAt" : "2019-11-06T14:35:28Z",
        "updatedAt" : "2019-11-07T14:26:30Z",
        "lastEditedBy" : {
          "login" : "SamirTalwar",
          "name" : "Samir Talwar",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/47582?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "2e6dea45-a6d1-4110-bd82-578801238ba1",
        "parentId" : "f335fc51-02ee-4249-bb67-cf3c2ce911c1",
        "author" : {
          "login" : "oliverse-da",
          "name" : "Oliver Seeliger",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/46452754?u=dd1d8e09760abe67b40a4e527a15aafe9d104d82&v=4"
        },
        "body" : "Interestingly that's the version that I had in our repo, but then I noticed that [SQLExecutor](https://github.com/digital-asset/daml/blob/master/ledger/sandbox/src/main/scala/com/digitalasset/platform/sandbox/stores/ledger/sql/util/SqlExecutor.scala#L36) combined the parameters in one list, so I combined them here as well.",
        "createdAt" : "2019-11-07T08:12:57Z",
        "updatedAt" : "2019-11-07T14:26:30Z",
        "lastEditedBy" : {
          "login" : "oliverse-da",
          "name" : "Oliver Seeliger",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/46452754?u=dd1d8e09760abe67b40a4e527a15aafe9d104d82&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "44d5106f-35d6-4cd3-89ca-dd81eaa08532",
        "parentId" : "f335fc51-02ee-4249-bb67-cf3c2ce911c1",
        "author" : {
          "login" : "oliverse-da",
          "name" : "Oliver Seeliger",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/46452754?u=dd1d8e09760abe67b40a4e527a15aafe9d104d82&v=4"
        },
        "body" : "Removed the HikariJdbcConnectionProvider.description parameter as part of moving the error logging from HikariJdbcConnectionProvider to SqlExecutor",
        "createdAt" : "2019-11-07T09:45:51Z",
        "updatedAt" : "2019-11-07T14:26:30Z",
        "lastEditedBy" : {
          "login" : "oliverse-da",
          "name" : "Oliver Seeliger",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/46452754?u=dd1d8e09760abe67b40a4e527a15aafe9d104d82&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "57b56f34c1c450872c0e56b48c140c1fe8a5ccab",
    "line" : null,
    "diffHunk" : "@@ -18,7 +18,7 @@ trait JdbcConnectionProvider extends AutoCloseable {\n     * is returned to the pool.\n     * The block must not recursively call [[runSQL]], as this could result in a deadlock\n     * waiting for a free connection from the same pool. */\n-  def runSQL[T](block: Connection => T): T\n+  def runSQL[T](description: String, block: Connection => T): T"
  }
]