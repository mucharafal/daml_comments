[
  {
    "id" : "57612932-9b63-4153-9981-6dc0b52db3b2",
    "prId" : 5732,
    "comments" : [
      {
        "id" : "82f95775-4406-463b-9c0f-13966dee97df",
        "parentId" : null,
        "author" : {
          "login" : "aherrmann-da",
          "name" : "Andreas Herrmann",
          "avatarUrl" : "https://avatars3.githubusercontent.com/u/42969706?v=4"
        },
        "body" : "Yes, this is a very unfortunate aspect of the runfiles mechanism. Another solution is to pass in the rootpath instead of the short path. Sadly that requires extra hoops to jump through. In this case it looks like all those are `Target`s and have `Label`s. So, you could call [`expand_location`](https://docs.bazel.build/versions/master/skylark/lib/ctx.html#expand_location) to obtain the `$(rootpath)`.",
        "createdAt" : "2020-04-28T13:40:16Z",
        "updatedAt" : "2020-04-28T13:55:45Z",
        "lastEditedBy" : {
          "login" : "aherrmann-da",
          "name" : "Andreas Herrmann",
          "avatarUrl" : "https://avatars3.githubusercontent.com/u/42969706?v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "a371158c-190a-4ab0-965d-a86f50efd4c1",
        "parentId" : "82f95775-4406-463b-9c0f-13966dee97df",
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "I’ll leave it for now since this seems to work and I’m scared to touch it now :fearful: ",
        "createdAt" : "2020-04-28T13:58:07Z",
        "updatedAt" : "2020-04-28T13:58:07Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "9a02dc4431886e43afc54ca6a0bc663365cc2ed6",
    "line" : 12,
    "diffHunk" : "@@ -12,25 +12,35 @@ def _client_server_test_impl(ctx):\n         output = wrapper,\n         content = \"\"\"#!/usr/bin/env bash\n set -eou pipefail\n+canonicalize_rlocation() {{\n+  # Note (MK): This is a fun one: Let’s say $TEST_WORKSPACE is \"compatibility\"\n+  # and the argument points to a target from an external workspace, e.g.,\n+  # @daml-sdk-0.0.0//:daml. Then the short path will point to\n+  # ../daml-sdk-0.0.0/daml. Putting things together we end up with\n+  # compatibility/../daml-sdk-0.0.0/daml. On Linux and MacOS this works\n+  # just fine. However, on windows we need to normalize the path\n+  # or rlocation will fail to find the path in the manifest file.\n+  rlocation $(realpath -L -s -m --relative-to=$PWD $TEST_WORKSPACE/$1)"
  }
]