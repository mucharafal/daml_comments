[
  {
    "id" : "10485c34-764f-4f9e-80b9-1d5987f939bb",
    "prId" : 1934,
    "comments" : [
      {
        "id" : "c05797fd-2d62-409c-bd96-1f1bb9be47f8",
        "parentId" : null,
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "I'm starting to wonder if `runAction` should always convert `BadDependency` into a `Nothing` on its own? Or have `runActionMaybe` to encapsulate that behaviour?",
        "createdAt" : "2019-06-28T09:25:05Z",
        "updatedAt" : "2019-06-28T09:25:55Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "e5387387-88b2-45d3-a33a-0c32587f5705",
        "parentId" : "c05797fd-2d62-409c-bd96-1f1bb9be47f8",
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "Sounds reasonable but I also don’t really mind the `MaybeT` stuff now that I’ve gotten used to it.",
        "createdAt" : "2019-06-28T10:51:17Z",
        "updatedAt" : "2019-06-28T10:51:17Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "ceea1c3d-75c6-4737-98ac-3383fb02a862",
        "parentId" : "c05797fd-2d62-409c-bd96-1f1bb9be47f8",
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "It's irking me more every day... I guess the tables have turned. If it irks me enough I'll do the needful.",
        "createdAt" : "2019-06-28T12:15:29Z",
        "updatedAt" : "2019-06-28T12:15:29Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "6d72f670fc1a875254b25abf93ca03739b3dac26",
    "line" : 71,
    "diffHunk" : "@@ -171,7 +157,7 @@ buildDar service file mbExposedModules pkgName sdkVersion buildDataFiles dalfInp\n         []\n         pkgName\n         sdkVersion\n-    else actionToExceptT service $ runMaybeT $ do\n+    else runAction service $ runMaybeT $ do"
  },
  {
    "id" : "59ace4f1-056b-4894-bd81-1b63e7e8e056",
    "prId" : 1933,
    "comments" : [
      {
        "id" : "8665cb3c-d805-4dbb-8939-dc73fb1fa62b",
        "parentId" : null,
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "Unless I am missing something this means that the error will not be shown by default. The right solution here is probably to not go via the logger at all and instead emit an error diagnostic.",
        "createdAt" : "2019-06-28T09:28:41Z",
        "updatedAt" : "2019-06-28T09:54:13Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "af7c5625-0b1b-4464-82ee-720c087ce1ed",
        "parentId" : "8665cb3c-d805-4dbb-8939-dc73fb1fa62b",
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "I don't think this was ever right - call logError and then `fail` isn't the way to go. I have fixed it for now by just turning it into a `error` with an error message, and abort the whole thing, which should be no worse than before, but the whole thing is pretty dodgy. I added a FIXME.",
        "createdAt" : "2019-06-28T09:54:28Z",
        "updatedAt" : "2019-06-28T09:54:28Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "97faac2d-9a8e-4599-a137-83466e6270ed",
        "parentId" : "8665cb3c-d805-4dbb-8939-dc73fb1fa62b",
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "@cocreature can you confirm this seems OK temporarily?",
        "createdAt" : "2019-06-28T10:24:52Z",
        "updatedAt" : "2019-06-28T10:24:52Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "ef67d4de-ab4d-4979-b06c-6b79b9b5cfce",
        "parentId" : "8665cb3c-d805-4dbb-8939-dc73fb1fa62b",
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "LGTM :+1:",
        "createdAt" : "2019-06-28T10:50:55Z",
        "updatedAt" : "2019-06-28T10:50:55Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "f5cd40415f30e84edf5deaef7ac1d3d4055fb229",
    "line" : null,
    "diffHunk" : "@@ -176,7 +175,7 @@ buildDar service file mbExposedModules pkgName sdkVersion buildDataFiles dalfInp\n       let pkgModuleNames = S.fromList $ map T.unpack $ LF.packageModuleNames pkg\n       let missingExposed = S.fromList (fromMaybe [] mbExposedModules) S.\\\\ pkgModuleNames\n       unless (S.null missingExposed) $ do\n-          liftIO $ IdeLogger.logSeriousError (ideLogger service) $\n+          liftIO $ IdeLogger.logInfo (ideLogger service) $"
  },
  {
    "id" : "71167395-cc56-4f68-8d7d-a984dd22bcb2",
    "prId" : 1793,
    "comments" : [
      {
        "id" : "921a869b-38a8-4ef1-b4a0-f83a049f711d",
        "parentId" : null,
        "author" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "body" : "Why do we fail without any useful message here?",
        "createdAt" : "2019-06-21T12:52:56Z",
        "updatedAt" : "2019-06-21T12:53:13Z",
        "lastEditedBy" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "f369b6d7-4aef-4e7a-a980-6afb38781b8c",
        "parentId" : "921a869b-38a8-4ef1-b4a0-f83a049f711d",
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "We already emit the log message. There isn’t really any point in outputting it via diagnostics as well. And we are in MaybeT so the string here doesn’t matter either way.",
        "createdAt" : "2019-06-21T12:56:18Z",
        "updatedAt" : "2019-06-21T12:56:19Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "1fbb5b3a-4a49-43d2-9fbc-0cc861113555",
        "parentId" : "921a869b-38a8-4ef1-b4a0-f83a049f711d",
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "I'd have liked it if there was a function `nothing :: MaybeT m a` to make the intent clear. `fail` with no error is just odd, and in most other contexts, would be terrible.",
        "createdAt" : "2019-06-21T13:05:24Z",
        "updatedAt" : "2019-06-21T13:05:24Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "dc3a626d-d32f-49ef-84f8-e26a09d9ced5",
        "parentId" : "921a869b-38a8-4ef1-b4a0-f83a049f711d",
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "I considered `MaybeT (pure Nothing)` but that looks awkward. `empty` is nice but also somewhat unclear so `fail \"\"` seemed like the best option.",
        "createdAt" : "2019-06-21T13:07:12Z",
        "updatedAt" : "2019-06-21T13:07:13Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "750fc30c-e30b-4a83-a6a4-eaf00e777b80",
        "parentId" : "921a869b-38a8-4ef1-b4a0-f83a049f711d",
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "I was about to add a github issue for adding something to `transformers`, or even a PR, but then I saw that it's on hub.darcs.net, which is a sign the project is so unmaintained i might as well not bother.",
        "createdAt" : "2019-06-21T13:11:25Z",
        "updatedAt" : "2019-06-21T13:11:25Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "381e762a5bfe0ddf68af4408be96f3b558d472dd",
    "line" : 171,
    "diffHunk" : "@@ -210,60 +187,40 @@ buildDar service file mbExposedModules pkgName sdkVersion buildDataFiles dalfInp\n         []\n         pkgName\n         sdkVersion\n-    else do\n-      pkg <- compileFile service file\n+    else actionToExceptT service $ runMaybeT $ do\n+      pkg <- useE GeneratePackage file\n       let pkgModuleNames = S.fromList $ map T.unpack $ LF.packageModuleNames pkg\n       let missingExposed = S.fromList (fromMaybe [] mbExposedModules) S.\\\\ pkgModuleNames\n       unless (S.null missingExposed) $ do\n-          liftIO $ CompilerService.logSeriousError service $\n+          liftIO $ logSeriousError service $\n               \"The following modules are declared in exposed-modules but are not part of the DALF: \" <>\n               T.pack (show $ S.toList missingExposed)\n-          throwE []\n+          fail \"\""
  },
  {
    "id" : "7b577ad8-a9ac-4f91-9d4d-cfb010d684b3",
    "prId" : 1707,
    "comments" : [
      {
        "id" : "94cbf14f-96a2-42e8-ad1b-0c0a35843ffa",
        "parentId" : null,
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "Why go via the Ide here? Seems almost overkill for parsing a module",
        "createdAt" : "2019-06-17T11:54:03Z",
        "updatedAt" : "2019-06-17T14:05:04Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "f5833a3e-ed46-4b33-82f6-15299787df59",
        "parentId" : "94cbf14f-96a2-42e8-ad1b-0c0a35843ffa",
        "author" : {
          "login" : "robin-da",
          "name" : "Robin Krom",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/14074936?u=1b47fdbdfd82ea534219fc1b94d646873c56a7d7&v=4"
        },
        "body" : "Seemed like the most straight forward option. Can I call `parseFile` directly without repeating a lot of work to setup state for GHC?",
        "createdAt" : "2019-06-17T12:25:24Z",
        "updatedAt" : "2019-06-17T14:05:04Z",
        "lastEditedBy" : {
          "login" : "robin-da",
          "name" : "Robin Krom",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/14074936?u=1b47fdbdfd82ea534219fc1b94d646873c56a7d7&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "e51fe96f-8295-4014-93f9-6d7967def048",
        "parentId" : "94cbf14f-96a2-42e8-ad1b-0c0a35843ffa",
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "Perhaps. Perhaps not... I'm not that sure, but if it seems hard, stick with what you have.",
        "createdAt" : "2019-06-17T12:26:23Z",
        "updatedAt" : "2019-06-17T14:05:04Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "2c4e7e69876be18b89db41c246ef31aad2dcd83d",
    "line" : 25,
    "diffHunk" : "@@ -168,6 +170,21 @@ compileFile service fp = do\n             throwE diag\n         Just v -> return v\n \n+-- | Parse the supplied file to a ghc ParsedModule.\n+parseFile\n+    :: IdeState\n+    -> NormalizedFilePath\n+    -> ExceptT [FileDiagnostic] IO ParsedModule\n+parseFile service fp = do"
  },
  {
    "id" : "41f78249-de82-4e4b-b407-6e962d0ad8a7",
    "prId" : 1508,
    "comments" : [
      {
        "id" : "933d7e59-e2cf-407d-a178-2377a70101fd",
        "parentId" : null,
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "Can we now simplify this to always being present, and people can pass `\\x -> return ()` if they don't want to do something. I hated the fact we switched on it, so nice work fixing that bit.",
        "createdAt" : "2019-06-04T12:47:33Z",
        "updatedAt" : "2019-06-04T14:03:55Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "efb260d2-0c2d-446e-ad79-23f9087e3c90",
        "parentId" : "933d7e59-e2cf-407d-a178-2377a70101fd",
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "Good idea, changed!",
        "createdAt" : "2019-06-04T13:13:52Z",
        "updatedAt" : "2019-06-04T14:03:55Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "17411959141284526399ee9f2ef5735ad2a26033",
    "line" : null,
    "diffHunk" : "@@ -149,42 +146,39 @@ data DalfDependency = DalfDependency\n newtype GlobalPkgMap = GlobalPkgMap (Map.Map UnitId (LF.PackageId, LF.Package, BS.ByteString, FilePath))\n instance Shake.IsIdeGlobal GlobalPkgMap\n \n-newIdeState :: Options\n-            -> Maybe (Event -> IO ())\n-            -> Logger.Handle IO\n-            -- This type is rather awkward. The reason for this is that\n-            -- we can only fully initialize the IdeState once we get the\n-            -- LspFuncs in the initialize callback.\n-            -- We should move away from Managed (we only use it for the scenario service)\n-            -- and then refactor this.\n-            -> Managed (VFSHandle -> IO IdeState)\n-newIdeState compilerOpts mbEventHandler loggerH = do\n-    mbScenarioService <-\n-        for (guard (optScenarioService compilerOpts) >> mbEventHandler) $ \\eventHandler ->\n-            Scenario.startScenarioService eventHandler loggerH\n-\n+getIdeState\n+    :: Options\n+    -> Maybe Scenario.Handle\n+    -> Logger.Handle IO\n+    -> Maybe (Event -> IO ())"
  },
  {
    "id" : "4c438e41-af35-47c7-90f6-bd2556ed81b6",
    "prId" : 1489,
    "comments" : [
      {
        "id" : "0fa12eef-0af9-4542-b712-d25d4628563b",
        "parentId" : null,
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "Agreed!",
        "createdAt" : "2019-06-03T13:15:23Z",
        "updatedAt" : "2019-06-03T13:44:22Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "8a46b2d8b9b426b7e201afee1fde0bfd4ba9efef",
    "line" : 30,
    "diffHunk" : "@@ -151,7 +152,12 @@ instance Shake.IsIdeGlobal GlobalPkgMap\n newIdeState :: Options\n             -> Maybe (Event -> IO ())\n             -> Logger.Handle IO\n-            -> Managed IdeState\n+            -- This type is rather awkward. The reason for this is that\n+            -- we can only fully initialize the IdeState once we get the\n+            -- LspFuncs in the initialize callback.\n+            -- We should move away from Managed (we only use it for the scenario service)"
  },
  {
    "id" : "0dd7ab7a-f09b-4f2c-8988-cceabd6f136d",
    "prId" : 1489,
    "comments" : [
      {
        "id" : "6e8106cf-6545-4202-bfcd-b5719ce018c7",
        "parentId" : null,
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "Would be nice to kill this Int.",
        "createdAt" : "2019-06-03T13:15:51Z",
        "updatedAt" : "2019-06-03T13:44:22Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "8a46b2d8b9b426b7e201afee1fde0bfd4ba9efef",
    "line" : 65,
    "diffHunk" : "@@ -258,12 +279,11 @@ compileFile service fp = do\n onFileModified\n     :: IdeState\n     -> FilePath\n-    -> Maybe T.Text\n+    -> Maybe (T.Text, Int)\n     -> IO ()\n-onFileModified service fp mcontents = do\n+onFileModified service fp mbContents = do"
  },
  {
    "id" : "d96e7325-f43a-4bc8-bb11-7902a7dcf368",
    "prId" : 1375,
    "comments" : [
      {
        "id" : "028ba9f7-13d1-4f15-8bde-fd6e977bcfb6",
        "parentId" : null,
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "It looks like the scenario service only uses the event handler to log exceptions and those are also written to the logger. So we can probably change this fairly easily to have `optScenarioService` fully control whether we start the scenario service instead of this somewhat weird behavior where it can only be used to disable but not enable the scenario service. Totally fine to do that in a separate PR.",
        "createdAt" : "2019-05-24T11:24:59Z",
        "updatedAt" : "2019-05-24T11:54:56Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "f301b336-b803-4af4-ae97-887331cc4eb9",
        "parentId" : "028ba9f7-13d1-4f15-8bde-fd6e977bcfb6",
        "author" : null,
        "body" : ":+1:\r\n",
        "createdAt" : "2019-05-24T11:41:47Z",
        "updatedAt" : "2019-05-24T11:54:56Z",
        "lastEditedBy" : null,
        "tags" : [
        ]
      }
    ],
    "commit" : "edffa058c14cf689cad5014010b84571f5906461",
    "line" : 14,
    "diffHunk" : "@@ -153,15 +153,17 @@ newIdeState :: Options\n             -> Logger.Handle IO\n             -> Managed IdeState\n newIdeState compilerOpts mbEventHandler loggerH = do\n-  mbScenarioService <- for mbEventHandler $ \\eventHandler -> Scenario.startScenarioService eventHandler loggerH\n-\n-  -- Load the packages from the package database for the scenario service. We swallow errors here\n-  -- but shake will report them when typechecking anything.\n-  (_diags, pkgMap) <- liftIO $ CompilerService.generatePackageMap (optPackageDbs compilerOpts)\n-  let rule = do\n-        CompilerService.mainRule compilerOpts\n-        Shake.addIdeGlobal $ GlobalPkgMap pkgMap\n-  liftIO $ CompilerService.initialise rule mbEventHandler (toIdeLogger loggerH) compilerOpts mbScenarioService\n+    mbScenarioService <-\n+        for (guard (optScenarioService compilerOpts) >> mbEventHandler) $ \\eventHandler ->"
  }
]