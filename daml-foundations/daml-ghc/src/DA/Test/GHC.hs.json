[
  {
    "id" : "d98e38d2-f55a-4a53-b48b-d0accc13ff70",
    "prId" : 695,
    "comments" : [
      {
        "id" : "3faee47b-9766-4d46-adea-f210d3ec82b6",
        "parentId" : null,
        "author" : {
          "login" : "rohanjr-da",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars3.githubusercontent.com/u/30991659?u=e2e9aeb4fcbc3e6ca8f66a126ca0821c75419d31&v=4"
        },
        "body" : "@martin-drhu-da Do you know why we need the `transformOn`? I was just finishing/testing my work on this and it looks like it's not needed. Also I used `encodePayload pkg` (from https://github.com/digital-asset/daml/blob/master/compiler/daml-lf-proto/src/DA/Daml/LF/Proto3/Encode.hs#L12) instead of the `JSONPB` stuff. Looks like our results are the same though. :)",
        "createdAt" : "2019-04-29T08:46:47Z",
        "updatedAt" : "2019-04-29T08:46:47Z",
        "lastEditedBy" : {
          "login" : "rohanjr-da",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars3.githubusercontent.com/u/30991659?u=e2e9aeb4fcbc3e6ca8f66a126ca0821c75419d31&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "9c9f292c-139c-4919-a144-aa8962cfb204",
        "parentId" : "3faee47b-9766-4d46-adea-f210d3ec82b6",
        "author" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "body" : "IIRC, the `transformOn` encodes numbers as strings. This is a workaround for the circumstance that JSON numbers are all double and we sometimes lose precision.",
        "createdAt" : "2019-04-30T08:40:54Z",
        "updatedAt" : "2019-04-30T08:40:55Z",
        "lastEditedBy" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "e99a8783cffeba68ec0da66f3f08de6fa371682d",
    "line" : 21,
    "diffHunk" : "@@ -175,7 +177,7 @@ runJqQuery log qs = do\n     log $ \"running jq query: \" ++ q\n \n     let jq = \"external\" </> \"jq\" </> \"bin\" </> \"jq\"\n-    let json = unpack $ A.encode $ transformOn A._Value numToString $ A.toJSON pkg\n+    let json = unpack $ A.encode $ transformOn A._Value numToString $ JSONPB.toJSONPB (encodePackage pkg) JSONPB.jsonPBOptions"
  }
]