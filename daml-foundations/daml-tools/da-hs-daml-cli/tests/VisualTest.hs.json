[
  {
    "id" : "04e4cf3d-4f28-4033-940c-8769162acff2",
    "prId" : 1727,
    "comments" : [
      {
        "id" : "8b474f0b-4989-49ca-8d87-ea1a6959928e",
        "parentId" : null,
        "author" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "body" : "We should call this something like `shouldHaveEqualContents`.",
        "createdAt" : "2019-06-19T08:00:54Z",
        "updatedAt" : "2019-06-21T11:47:50Z",
        "lastEditedBy" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "e1ea1467-14bb-40b8-9a06-f0bbbcc6b729",
        "parentId" : "8b474f0b-4989-49ca-8d87-ea1a6959928e",
        "author" : {
          "login" : "akalburgi",
          "name" : "Anup Kalburgi",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/42743833?v=4"
        },
        "body" : "replaced with a function already in Tasty ",
        "createdAt" : "2019-06-19T15:56:42Z",
        "updatedAt" : "2019-06-21T11:47:50Z",
        "lastEditedBy" : {
          "login" : "akalburgi",
          "name" : "Anup Kalburgi",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/42743833?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "01a59a57d14e901916e81ef1eabf16d6bc8e1244",
    "line" : null,
    "diffHunk" : "@@ -0,0 +1,39 @@\n+-- Copyright (c) 2019 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.\n+-- SPDX-License-Identifier: Apache-2.0\n+{-# LANGUAGE OverloadedStrings #-}\n+module VisualTest\n+   ( main\n+   ) where\n+\n+import Test.Tasty\n+import Test.Tasty.HUnit\n+import System.Directory\n+import System.IO.Extra\n+import DA.Cli.Visual\n+\n+\n+main :: IO ()\n+main = defaultMain tests\n+\n+tests :: TestTree\n+tests = testGroup \"Tests\" [unitTests]\n+\n+unitTests :: TestTree\n+unitTests = testGroup \"Unit tests\"\n+  [\n+    testCase \"file exists\" (doesFileExist \"daml-foundations/daml-tools/da-hs-daml-cli/visual-test-daml.dar\" @? \"missing dar file to process\") ,\n+    testCase \"file exists\" (doesFileExist \"daml-foundations/daml-tools/da-hs-daml-cli/tests/res/out.dot\" @? \"missing the expected dot file to check\") ,\n+    testCase \"dot file check\" $ do\n+        withTempFile $ \\path -> do\n+            let darPath = \"daml-foundations/daml-tools/da-hs-daml-cli/visual-test-daml.dar\"\n+            _ <- execVisual darPath (Just path)\n+            shouldThrow path \"daml-foundations/daml-tools/da-hs-daml-cli/tests/res/out.dot\"\n+  ]\n+\n+\n+shouldThrow :: FilePath -> FilePath -> IO ()"
  },
  {
    "id" : "5ba8c6ff-07df-489b-ab28-58db420d531d",
    "prId" : 1727,
    "comments" : [
      {
        "id" : "6769a070-2b86-40de-a3bc-0fedb26c232d",
        "parentId" : null,
        "author" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "body" : "```suggestion\r\n    ac <- readFile a\r\n```",
        "createdAt" : "2019-06-19T08:01:11Z",
        "updatedAt" : "2019-06-21T11:47:50Z",
        "lastEditedBy" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "01a59a57d14e901916e81ef1eabf16d6bc8e1244",
    "line" : null,
    "diffHunk" : "@@ -0,0 +1,39 @@\n+-- Copyright (c) 2019 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.\n+-- SPDX-License-Identifier: Apache-2.0\n+{-# LANGUAGE OverloadedStrings #-}\n+module VisualTest\n+   ( main\n+   ) where\n+\n+import Test.Tasty\n+import Test.Tasty.HUnit\n+import System.Directory\n+import System.IO.Extra\n+import DA.Cli.Visual\n+\n+\n+main :: IO ()\n+main = defaultMain tests\n+\n+tests :: TestTree\n+tests = testGroup \"Tests\" [unitTests]\n+\n+unitTests :: TestTree\n+unitTests = testGroup \"Unit tests\"\n+  [\n+    testCase \"file exists\" (doesFileExist \"daml-foundations/daml-tools/da-hs-daml-cli/visual-test-daml.dar\" @? \"missing dar file to process\") ,\n+    testCase \"file exists\" (doesFileExist \"daml-foundations/daml-tools/da-hs-daml-cli/tests/res/out.dot\" @? \"missing the expected dot file to check\") ,\n+    testCase \"dot file check\" $ do\n+        withTempFile $ \\path -> do\n+            let darPath = \"daml-foundations/daml-tools/da-hs-daml-cli/visual-test-daml.dar\"\n+            _ <- execVisual darPath (Just path)\n+            shouldThrow path \"daml-foundations/daml-tools/da-hs-daml-cli/tests/res/out.dot\"\n+  ]\n+\n+\n+shouldThrow :: FilePath -> FilePath -> IO ()\n+shouldThrow a b = do\n+    ac <-  readFile a"
  },
  {
    "id" : "400c7f53-adf2-4e79-9ffc-75941314382f",
    "prId" : 1727,
    "comments" : [
      {
        "id" : "6997c6db-97b7-4dee-ad4a-68aa7bc73596",
        "parentId" : null,
        "author" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "body" : "I'm not sure this test and the one below are useful. I think there's not guarantee that the test are run in order anyway.",
        "createdAt" : "2019-06-19T08:02:18Z",
        "updatedAt" : "2019-06-21T11:47:50Z",
        "lastEditedBy" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "0eccd572-7ff7-4b97-b5c1-020e845505f7",
        "parentId" : "6997c6db-97b7-4dee-ad4a-68aa7bc73596",
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "Yeah, use a temp file for the test, and then you don't have the problem anyway",
        "createdAt" : "2019-06-19T08:07:49Z",
        "updatedAt" : "2019-06-21T11:47:50Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "75b6712e-cc7f-4f69-883a-9487773cc799",
        "parentId" : "6997c6db-97b7-4dee-ad4a-68aa7bc73596",
        "author" : {
          "login" : "akalburgi",
          "name" : "Anup Kalburgi",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/42743833?v=4"
        },
        "body" : "These tests are not necessary. I added it in when I was messing around with bazel rules. Will get rid of them. If the files are not present the bazel command fails. So these tests are redundant. ",
        "createdAt" : "2019-06-19T13:22:53Z",
        "updatedAt" : "2019-06-21T11:47:50Z",
        "lastEditedBy" : {
          "login" : "akalburgi",
          "name" : "Anup Kalburgi",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/42743833?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "01a59a57d14e901916e81ef1eabf16d6bc8e1244",
    "line" : null,
    "diffHunk" : "@@ -0,0 +1,39 @@\n+-- Copyright (c) 2019 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.\n+-- SPDX-License-Identifier: Apache-2.0\n+{-# LANGUAGE OverloadedStrings #-}\n+module VisualTest\n+   ( main\n+   ) where\n+\n+import Test.Tasty\n+import Test.Tasty.HUnit\n+import System.Directory\n+import System.IO.Extra\n+import DA.Cli.Visual\n+\n+\n+main :: IO ()\n+main = defaultMain tests\n+\n+tests :: TestTree\n+tests = testGroup \"Tests\" [unitTests]\n+\n+unitTests :: TestTree\n+unitTests = testGroup \"Unit tests\"\n+  [\n+    testCase \"file exists\" (doesFileExist \"daml-foundations/daml-tools/da-hs-daml-cli/visual-test-daml.dar\" @? \"missing dar file to process\") ,"
  },
  {
    "id" : "b5afe73c-2f58-431b-a159-0d0c9566a51f",
    "prId" : 1727,
    "comments" : [
      {
        "id" : "b570087d-9304-4e87-b784-096e2e1172be",
        "parentId" : null,
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "This seems a really odd test and a really odd way to assert a file doesn't exist",
        "createdAt" : "2019-06-19T08:08:34Z",
        "updatedAt" : "2019-06-21T11:47:50Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "ccfaf78f-0a5f-4be4-8c2c-f0e3abf818ac",
        "parentId" : "b570087d-9304-4e87-b784-096e2e1172be",
        "author" : {
          "login" : "akalburgi",
          "name" : "Anup Kalburgi",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/42743833?v=4"
        },
        "body" : "removed the redundant tests ",
        "createdAt" : "2019-06-19T15:57:44Z",
        "updatedAt" : "2019-06-21T11:47:50Z",
        "lastEditedBy" : {
          "login" : "akalburgi",
          "name" : "Anup Kalburgi",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/42743833?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "01a59a57d14e901916e81ef1eabf16d6bc8e1244",
    "line" : null,
    "diffHunk" : "@@ -0,0 +1,39 @@\n+-- Copyright (c) 2019 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.\n+-- SPDX-License-Identifier: Apache-2.0\n+{-# LANGUAGE OverloadedStrings #-}\n+module VisualTest\n+   ( main\n+   ) where\n+\n+import Test.Tasty\n+import Test.Tasty.HUnit\n+import System.Directory\n+import System.IO.Extra\n+import DA.Cli.Visual\n+\n+\n+main :: IO ()\n+main = defaultMain tests\n+\n+tests :: TestTree\n+tests = testGroup \"Tests\" [unitTests]\n+\n+unitTests :: TestTree\n+unitTests = testGroup \"Unit tests\"\n+  [\n+    testCase \"file exists\" (doesFileExist \"daml-foundations/daml-tools/da-hs-daml-cli/visual-test-daml.dar\" @? \"missing dar file to process\") ,\n+    testCase \"file exists\" (doesFileExist \"daml-foundations/daml-tools/da-hs-daml-cli/tests/res/out.dot\" @? \"missing the expected dot file to check\") ,\n+    testCase \"dot file check\" $ do\n+        withTempFile $ \\path -> do\n+            let darPath = \"daml-foundations/daml-tools/da-hs-daml-cli/visual-test-daml.dar\"\n+            _ <- execVisual darPath (Just path)\n+            shouldThrow path \"daml-foundations/daml-tools/da-hs-daml-cli/tests/res/out.dot\""
  }
]