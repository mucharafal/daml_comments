[
  {
    "id" : "f3893f60-f3eb-4b8e-aaca-e88c89e15c5d",
    "prId" : 3233,
    "comments" : [
      {
        "id" : "7cfb703c-b732-4714-9199-f099777930a0",
        "parentId" : null,
        "author" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "body" : "Shouldn't we be using an `exit` trap for removing the temp dir? With this change, we can also remove the `rm -rf /tmp/*` from the Dockerfile again.",
        "createdAt" : "2019-10-18T14:27:06Z",
        "updatedAt" : "2019-10-18T14:43:10Z",
        "lastEditedBy" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "a3f221e2-d965-4863-b19e-d2554045e369",
        "parentId" : "7cfb703c-b732-4714-9199-f099777930a0",
        "author" : null,
        "body" : "We're already using an exit trap for errors which removes the temp dir ... I suppose we could have two exit traps.",
        "createdAt" : "2019-10-18T14:35:41Z",
        "updatedAt" : "2019-10-18T14:43:10Z",
        "lastEditedBy" : null,
        "tags" : [
        ]
      },
      {
        "id" : "f240aeba-583d-4a38-8d19-a197cecaefc5",
        "parentId" : "7cfb703c-b732-4714-9199-f099777930a0",
        "author" : null,
        "body" : "Removed `rm -rf /tmp/*` from the Dockerfile.",
        "createdAt" : "2019-10-18T14:43:36Z",
        "updatedAt" : "2019-10-18T14:43:37Z",
        "lastEditedBy" : null,
        "tags" : [
        ]
      },
      {
        "id" : "8415e343-b7ff-4781-8fa6-34ff9016c229",
        "parentId" : "7cfb703c-b732-4714-9199-f099777930a0",
        "author" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "body" : "Can we just put this into the already existing exit trap then?",
        "createdAt" : "2019-10-18T15:55:37Z",
        "updatedAt" : "2019-10-18T15:55:37Z",
        "lastEditedBy" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "03b483c8cd54bc7c142751e95673ad6b2b401a18",
    "line" : 8,
    "diffHunk" : "@@ -17,14 +17,17 @@\n #\n \n set -eu\n+readonly SWD=\"$PWD\"\n+readonly TMPDIR=\"$(mktemp -d)\"\n+cd $TMPDIR\n+\n cleanup() {"
  },
  {
    "id" : "6b0ff34f-a729-4dce-9c87-a0f4ebee99ca",
    "prId" : 1488,
    "comments" : [
      {
        "id" : "dd503e30-6467-495d-9d7c-66130563416c",
        "parentId" : null,
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "I would just be explicit and use `ARG1=\"${1:-}\" instead (or do that later when you reference it).",
        "createdAt" : "2019-06-03T07:50:57Z",
        "updatedAt" : "2019-06-03T08:02:35Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "3db91ad6-f3f5-467c-9cb7-32b57db24299",
        "parentId" : "dd503e30-6467-495d-9d7c-66130563416c",
        "author" : null,
        "body" : "Thanks! :+1: ",
        "createdAt" : "2019-06-03T08:02:52Z",
        "updatedAt" : "2019-06-03T08:02:52Z",
        "lastEditedBy" : null,
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "97f2a8b707d91cdba9693b91d222899955d8270d",
    "line" : null,
    "diffHunk" : "@@ -10,7 +10,20 @@\n # For more information please visit https://daml.com/ and https://docs.daml.com/\n #\n \n+#\n+# USAGE:\n+#    get-daml.sh            Download and install the latest DAML SDK release.\n+#    get-daml.sh VERSION    Download and install given version of DAML SDK.\n+#\n+\n+ARG1=\"$1\""
  },
  {
    "id" : "a8165e2d-8806-4f2f-9852-fe3e36dc0853",
    "prId" : 1488,
    "comments" : [
      {
        "id" : "fe35393d-e03b-462a-b414-beba8a470d0d",
        "parentId" : null,
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "Could we say the version number on this line? That would be nice.",
        "createdAt" : "2019-06-03T13:00:30Z",
        "updatedAt" : "2019-06-03T13:01:15Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "45f5c3ec-4504-4905-9454-7840e3b9ea4a",
        "parentId" : "fe35393d-e03b-462a-b414-beba8a470d0d",
        "author" : null,
        "body" : "Sure! I'll make another PR since this one is already merged.",
        "createdAt" : "2019-06-03T13:52:34Z",
        "updatedAt" : "2019-06-03T13:52:34Z",
        "lastEditedBy" : null,
        "tags" : [
        ]
      }
    ],
    "commit" : "97f2a8b707d91cdba9693b91d222899955d8270d",
    "line" : 47,
    "diffHunk" : "@@ -70,8 +81,8 @@ fi\n readonly TARBALL=\"daml-sdk-$VERSION-$OS.tar.gz\"\n readonly URL=\"https://github.com/digital-asset/daml/releases/download/v$VERSION/$TARBALL\"\n \n-echo \"$(tput setaf 3)Downloading latest DAML SDK. This may take a while.$(tput sgr 0)\"\n-curl -L $URL --output $TARBALL --progress-bar\n+echo \"$(tput setaf 3)Downloading DAML SDK. This may take a while.$(tput sgr 0)\""
  },
  {
    "id" : "f2bbcf51-62e1-4a15-ba80-d9e4e92ff43d",
    "prId" : 1121,
    "comments" : [
      {
        "id" : "ed6a1e25-5e63-4d0b-a54a-69a74014cea2",
        "parentId" : null,
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "```suggestion\r\n# DAML is an open-source privacy-aware smart contract language.\r\n```",
        "createdAt" : "2019-05-14T09:19:29Z",
        "updatedAt" : "2019-05-14T09:29:24Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "4ccda295-4648-4363-93e0-5e6d83804b79",
        "parentId" : "ed6a1e25-5e63-4d0b-a54a-69a74014cea2",
        "author" : null,
        "body" : "Thanks!",
        "createdAt" : "2019-05-14T09:25:34Z",
        "updatedAt" : "2019-05-14T09:29:24Z",
        "lastEditedBy" : null,
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "2ffeb55a0bb528133e80e49ecb2611fc7921c1b7",
    "line" : null,
    "diffHunk" : "@@ -4,21 +4,24 @@\n # SPDX-License-Identifier: Apache-2.0\n \n #\n+# DAML is an open-source privace aware smart contract language."
  },
  {
    "id" : "ae8bbcae-341d-4fa8-86c8-cca7321528ac",
    "prId" : 1121,
    "comments" : [
      {
        "id" : "4f034967-1a43-42b5-b3da-ec17ab289aa4",
        "parentId" : null,
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "https://daml.com etc - that way it's got a chance of rendering as a hyperlink if viewed on the console or a text editor.",
        "createdAt" : "2019-05-14T09:21:25Z",
        "updatedAt" : "2019-05-14T09:29:24Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "806fe620-3890-4cd7-8dae-9255d97ae51d",
        "parentId" : "4f034967-1a43-42b5-b3da-ec17ab289aa4",
        "author" : null,
        "body" : ":+1:\r\n",
        "createdAt" : "2019-05-14T09:25:22Z",
        "updatedAt" : "2019-05-14T09:29:24Z",
        "lastEditedBy" : null,
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "2ffeb55a0bb528133e80e49ecb2611fc7921c1b7",
    "line" : null,
    "diffHunk" : "@@ -4,21 +4,24 @@\n # SPDX-License-Identifier: Apache-2.0\n \n #\n+# DAML is an open-source privace aware smart contract language.\n # This script downloads and installs the DAML SDK on Linux and macOS.\n # This will overwrite any existing installation in ~/.daml\n+# For more information please visit daml.com and docs.daml.com"
  },
  {
    "id" : "19de7a4b-a267-45db-b473-f0dddf7849cf",
    "prId" : 750,
    "comments" : [
      {
        "id" : "9fc053cf-aa28-4c11-885e-5928f6416196",
        "parentId" : null,
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "I wonder if we should ask for confirmation before doing that. But at least for now, the only reason not to reinstall is bandwidth as the config file doesn’t contain anything particularly interesting so it’s probably fine",
        "createdAt" : "2019-04-29T07:23:23Z",
        "updatedAt" : "2019-04-29T07:23:30Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "a64b67d3-3829-4bce-8bb5-70eabcc75ebc",
        "parentId" : "9fc053cf-aa28-4c11-885e-5928f6416196",
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "Having a no prompt ever solution is much nicer for scripting this into a CI, which is where I'd want to use it.",
        "createdAt" : "2019-04-29T07:31:44Z",
        "updatedAt" : "2019-04-29T07:31:49Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "c82a53ec-2b99-44e4-9d87-60b18a7c37bd",
        "parentId" : "9fc053cf-aa28-4c11-885e-5928f6416196",
        "author" : null,
        "body" : "And removing the existing installation forcefully is a good default here since it means the user can't get into a state where `curl -sSL .../get-daml.sh | sh` won't solve their problem.\r\n\r\nShould I make an effort to preserve their config file nonetheless? Doing so *safely* probably means feeding the old config (if it exists) as an argument to `daml install`.",
        "createdAt" : "2019-04-29T07:39:42Z",
        "updatedAt" : "2019-04-29T07:41:06Z",
        "lastEditedBy" : null,
        "tags" : [
        ]
      },
      {
        "id" : "bfa10bf8-0a6b-467d-a80e-c98bfe38d5ed",
        "parentId" : "9fc053cf-aa28-4c11-885e-5928f6416196",
        "author" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "body" : "I think my preference would be yes, but at the same time, that sets you up for weird failures where the problem you were seeing is the old config file being wacky. How about we don't for now, and add the complexity later if users want it?",
        "createdAt" : "2019-04-29T07:44:14Z",
        "updatedAt" : "2019-04-29T07:44:14Z",
        "lastEditedBy" : {
          "login" : "neil-da",
          "name" : "Neil Mitchell",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/35463327?u=0eb1719958bc6e449ec5e7df3a312fa566f5055d&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "5525b635-eb07-4d9d-b227-ccfa53aa9c85",
        "parentId" : "9fc053cf-aa28-4c11-885e-5928f6416196",
        "author" : null,
        "body" : ":+1: sounds good",
        "createdAt" : "2019-04-29T07:45:14Z",
        "updatedAt" : "2019-04-29T07:45:14Z",
        "lastEditedBy" : null,
        "tags" : [
        ]
      },
      {
        "id" : "c27d32df-7f69-455d-8588-f7fc4198686f",
        "parentId" : "9fc053cf-aa28-4c11-885e-5928f6416196",
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : ":+1:",
        "createdAt" : "2019-04-29T07:57:50Z",
        "updatedAt" : "2019-04-29T07:57:50Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "1253d2b33fc070d527197d4613fb3c72b7dcec9a",
    "line" : 52,
    "diffHunk" : "@@ -65,6 +61,13 @@ readonly URL=\"https://github.com/digital-asset/daml/releases/download/v$VERSION/\n echo \"$(tput setaf 3)Downloading latest DAML SDK. This may take a while.$(tput sgr 0)\"\n curl -L $URL --output $TARBALL --progress-bar\n \n+readonly DAML_HOME=\"$HOME/.daml\"\n+if [ -d $DAML_HOME ] ; then\n+  echo \"Removing existing installation.\""
  },
  {
    "id" : "02f54fec-0926-4355-8435-1dc4fe93c3ab",
    "prId" : 656,
    "comments" : [
      {
        "id" : "5ac8adb9-20f6-4cdb-b53b-c16d2b609504",
        "parentId" : null,
        "author" : {
          "login" : "gleber-da",
          "name" : "gleber",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/34243031?u=682c8d513afbef14cd3f71d93040a37500b5b2d0&v=4"
        },
        "body" : "I suggest adding a check if the `curl` tool exists to provide a quality error message",
        "createdAt" : "2019-04-24T12:44:15Z",
        "updatedAt" : "2019-04-25T09:40:28Z",
        "lastEditedBy" : {
          "login" : "gleber-da",
          "name" : "gleber",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/34243031?u=682c8d513afbef14cd3f71d93040a37500b5b2d0&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "5c7a8622-2ffb-4deb-8079-8f948657ff19",
        "parentId" : "5ac8adb9-20f6-4cdb-b53b-c16d2b609504",
        "author" : null,
        "body" : "Will do, thanks!",
        "createdAt" : "2019-04-24T12:53:14Z",
        "updatedAt" : "2019-04-25T09:40:28Z",
        "lastEditedBy" : null,
        "tags" : [
        ]
      }
    ],
    "commit" : "1482871e59808284d4277ea71763661baa2bbb1b",
    "line" : 48,
    "diffHunk" : "@@ -0,0 +1,58 @@\n+#!/bin/bash\n+\n+# Copyright (c) 2019 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.\n+# SPDX-License-Identifier: Apache-2.0\n+\n+#\n+# This script downloads and installs the DAML SDK on Linux and macOS.\n+# This will overwrite any existing installation in ~/.daml\n+#\n+\n+readonly ORIGDIR=\"$(pwd)\"\n+function cleanup() {\n+  echo \"\"\n+  echo \"$(tput setaf 3)FAILED TO INSTALL!$(tput sgr 0)\"\n+  cd $ORIGDIR\n+}\n+trap cleanup EXIT\n+\n+readonly TMPDIR=\"$(mktemp -d)\"\n+cd $TMPDIR\n+\n+readonly DAML_HOME=\"$HOME/.daml\"\n+if [ -d $DAML_HOME ] ; then\n+  chmod -R u+w $DAML_HOME\n+  rm -rf $DAML_HOME\n+fi\n+\n+\n+echo \"Determining latest DAML version...\"\n+readonly VERSION=\"$(curl -s https://github.com/digital-asset/daml/releases/latest | sed 's/^.*github.com\\/digital-asset\\/daml\\/releases\\/tag\\/v//' | sed 's/\".*$//')\""
  },
  {
    "id" : "b2a32b88-1784-4f9b-a361-0e45a448c2e5",
    "prId" : 656,
    "comments" : [
      {
        "id" : "449a281f-793e-4c2d-89fc-87353a574213",
        "parentId" : null,
        "author" : {
          "login" : "gleber-da",
          "name" : "gleber",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/34243031?u=682c8d513afbef14cd3f71d93040a37500b5b2d0&v=4"
        },
        "body" : "ditto about `tar` command",
        "createdAt" : "2019-04-24T12:45:47Z",
        "updatedAt" : "2019-04-25T09:40:28Z",
        "lastEditedBy" : {
          "login" : "gleber-da",
          "name" : "gleber",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/34243031?u=682c8d513afbef14cd3f71d93040a37500b5b2d0&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "1482871e59808284d4277ea71763661baa2bbb1b",
    "line" : 70,
    "diffHunk" : "@@ -0,0 +1,58 @@\n+#!/bin/bash\n+\n+# Copyright (c) 2019 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.\n+# SPDX-License-Identifier: Apache-2.0\n+\n+#\n+# This script downloads and installs the DAML SDK on Linux and macOS.\n+# This will overwrite any existing installation in ~/.daml\n+#\n+\n+readonly ORIGDIR=\"$(pwd)\"\n+function cleanup() {\n+  echo \"\"\n+  echo \"$(tput setaf 3)FAILED TO INSTALL!$(tput sgr 0)\"\n+  cd $ORIGDIR\n+}\n+trap cleanup EXIT\n+\n+readonly TMPDIR=\"$(mktemp -d)\"\n+cd $TMPDIR\n+\n+readonly DAML_HOME=\"$HOME/.daml\"\n+if [ -d $DAML_HOME ] ; then\n+  chmod -R u+w $DAML_HOME\n+  rm -rf $DAML_HOME\n+fi\n+\n+\n+echo \"Determining latest DAML version...\"\n+readonly VERSION=\"$(curl -s https://github.com/digital-asset/daml/releases/latest | sed 's/^.*github.com\\/digital-asset\\/daml\\/releases\\/tag\\/v//' | sed 's/\".*$//')\"\n+echo \"Latest DAML version is $VERSION.\"\n+\n+\n+if [[ \"$OSTYPE\" == \"linux-gnu\" ]]; then\n+  OS=\"linux\"\n+elif [[ \"$OSTYPE\" == \"darwin\"* ]]; then\n+  OS=\"macos\"\n+else\n+  echo \"Operating system not supported:\"\n+  echo \"  OSTYPE = $OSTYPE\"\n+  exit 1\n+fi\n+\n+readonly TARBALL=\"daml-sdk-$VERSION-$OS.tar.gz\"\n+readonly URL=\"https://github.com/digital-asset/daml/releases/download/v$VERSION/$TARBALL\"\n+\n+echo \"$(tput setaf 3)Downloading latest DAML SDK. This may take a while.$(tput sgr 0)\"\n+curl -L $URL --output $TARBALL --progress-bar\n+\n+echo \"Extracting SDK release tarball.\"\n+mkdir -p $TMPDIR/sdk\n+tar xzf $TARBALL -C $TMPDIR/sdk --strip-components 1"
  }
]