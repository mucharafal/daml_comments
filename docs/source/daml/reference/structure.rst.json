[
  {
    "id" : "f75fc160-eabe-449d-9dea-648069831bfb",
    "prId" : 4134,
    "comments" : [
      {
        "id" : "d13601c2-b9de-4033-a78e-48610ffde7bf",
        "parentId" : null,
        "author" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "body" : "See above wrt disclosure.",
        "createdAt" : "2020-01-22T17:48:40Z",
        "updatedAt" : "2020-01-24T15:16:01Z",
        "lastEditedBy" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "36959950-745a-4b85-bc53-dde0fa7c39ce",
        "parentId" : "d13601c2-b9de-4033-a78e-48610ffde7bf",
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "But you mentioned divulgence above. :smile: ",
        "createdAt" : "2020-01-23T07:58:03Z",
        "updatedAt" : "2020-01-24T15:16:01Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "2142560c-b1a4-4650-b105-00ecb334b97e",
        "parentId" : "d13601c2-b9de-4033-a78e-48610ffde7bf",
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "Addressed by https://github.com/digital-asset/daml/pull/4134/commits/9203ad8001c19412ac5692a2a726415320a891c9",
        "createdAt" : "2020-01-23T15:32:26Z",
        "updatedAt" : "2020-01-24T15:16:01Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "11f52f472e3cb698771d149a1e0d4ac0a464f02a",
    "line" : null,
    "diffHunk" : "@@ -90,10 +90,26 @@ Here's the structure of a choice inside a template. There are two ways of specif\n \n     Who can exercise the choice.\n \n-:ref:`consumability <daml-ref-anytime>`\n-    ``nonconsuming`` keyword\n+:ref:`consumability <daml-ref-consumability>`\n \n-    By default, contracts are archived when a choice on them is exercised, which means that choices can no longer be exercised on them. If you include ``nonconsuming``, this choice can be exercised over and over.\n+    At most one of the following:\n+\n+    - ``preconsuming`` keyword\n+\n+        Exercising this choice archives the contract before the body is executed.\n+        Contracts created in the choice body are known to the signatories and controllers of the contracts as well as to the observers of the contract on which the choice was exercised."
  },
  {
    "id" : "3d737e25-0129-4189-8ca7-08ec07b630c8",
    "prId" : 4134,
    "comments" : [
      {
        "id" : "8a0f0ae8-2007-4148-b9f3-6a73fd964af2",
        "parentId" : null,
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "Technically you can be an observer and a controller so observers are not necessarily included. That said, I don’t think it’s really possible to misunderstand this so I would just keep the wording as is.",
        "createdAt" : "2020-01-23T15:40:18Z",
        "updatedAt" : "2020-01-24T15:16:01Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "11f52f472e3cb698771d149a1e0d4ac0a464f02a",
    "line" : null,
    "diffHunk" : "@@ -90,10 +90,26 @@ Here's the structure of a choice inside a template. There are two ways of specif\n \n     Who can exercise the choice.\n \n-:ref:`consumability <daml-ref-anytime>`\n-    ``nonconsuming`` keyword\n+:ref:`consumability <daml-ref-consumability>`\n \n-    By default, contracts are archived when a choice on them is exercised, which means that choices can no longer be exercised on them. If you include ``nonconsuming``, this choice can be exercised over and over.\n+    At most one of the following:\n+\n+    - ``preconsuming`` keyword\n+\n+        Exercising this choice archives the contract before the body is executed.\n+        Contracts created in the choice body are divulged exclusively to the respective signatories and controllers and not to the observers of the contract on which the choice was exercised."
  },
  {
    "id" : "e06301ae-54dc-4ddf-b398-aa65e4202268",
    "prId" : 4134,
    "comments" : [
      {
        "id" : "de988ec3-fb90-4cb9-a871-67c2db54669f",
        "parentId" : null,
        "author" : {
          "login" : "bame-da",
          "name" : "Bernhard Elsner",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/40762178?u=28b5edbfe9271d5db3fcfa3b80d30f93cce4321f&v=4"
        },
        "body" : "And here",
        "createdAt" : "2020-01-24T08:35:31Z",
        "updatedAt" : "2020-01-24T15:16:01Z",
        "lastEditedBy" : {
          "login" : "bame-da",
          "name" : "Bernhard Elsner",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/40762178?u=28b5edbfe9271d5db3fcfa3b80d30f93cce4321f&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "c76c3eaf-c7fe-443a-acc5-21fd3512a92e",
        "parentId" : "de988ec3-fb90-4cb9-a871-67c2db54669f",
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "Solved in https://github.com/digital-asset/daml/pull/4134/commits/11f52f472e3cb698771d149a1e0d4ac0a464f02a",
        "createdAt" : "2020-01-24T15:19:01Z",
        "updatedAt" : "2020-01-24T15:19:01Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "11f52f472e3cb698771d149a1e0d4ac0a464f02a",
    "line" : null,
    "diffHunk" : "@@ -90,10 +90,26 @@ Here's the structure of a choice inside a template. There are two ways of specif\n \n     Who can exercise the choice.\n \n-:ref:`consumability <daml-ref-anytime>`\n-    ``nonconsuming`` keyword\n+:ref:`consumability <daml-ref-consumability>`\n \n-    By default, contracts are archived when a choice on them is exercised, which means that choices can no longer be exercised on them. If you include ``nonconsuming``, this choice can be exercised over and over.\n+    At most one of the following:\n+\n+    - ``preconsuming`` keyword\n+\n+        Exercising this choice archives the contract before the body is executed.\n+        Contracts created in the choice body are divulged exclusively to the respective signatories and controllers and not to the observers of the contract on which the choice was exercised."
  },
  {
    "id" : "f599ebcd-06d1-4856-881e-e35e2762719f",
    "prId" : 4134,
    "comments" : [
      {
        "id" : "1df51a52-1a09-44a4-8d6e-3eace83d61d1",
        "parentId" : null,
        "author" : {
          "login" : "bame-da",
          "name" : "Bernhard Elsner",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/40762178?u=28b5edbfe9271d5db3fcfa3b80d30f93cce4321f&v=4"
        },
        "body" : "And here",
        "createdAt" : "2020-01-24T08:35:42Z",
        "updatedAt" : "2020-01-24T15:16:01Z",
        "lastEditedBy" : {
          "login" : "bame-da",
          "name" : "Bernhard Elsner",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/40762178?u=28b5edbfe9271d5db3fcfa3b80d30f93cce4321f&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "6bf4c5ac-cab5-451f-a328-9aad054e1bf2",
        "parentId" : "1df51a52-1a09-44a4-8d6e-3eace83d61d1",
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "Solved in https://github.com/digital-asset/daml/pull/4134/commits/11f52f472e3cb698771d149a1e0d4ac0a464f02a",
        "createdAt" : "2020-01-24T15:19:35Z",
        "updatedAt" : "2020-01-24T15:19:35Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "11f52f472e3cb698771d149a1e0d4ac0a464f02a",
    "line" : null,
    "diffHunk" : "@@ -90,10 +90,26 @@ Here's the structure of a choice inside a template. There are two ways of specif\n \n     Who can exercise the choice.\n \n-:ref:`consumability <daml-ref-anytime>`\n-    ``nonconsuming`` keyword\n+:ref:`consumability <daml-ref-consumability>`\n \n-    By default, contracts are archived when a choice on them is exercised, which means that choices can no longer be exercised on them. If you include ``nonconsuming``, this choice can be exercised over and over.\n+    At most one of the following:\n+\n+    - ``preconsuming`` keyword\n+\n+        Exercising this choice archives the contract before the body is executed.\n+        Contracts created in the choice body are divulged exclusively to the respective signatories and controllers and not to the observers of the contract on which the choice was exercised.\n+\n+    - ``postconsuming`` keyword\n+\n+        Exercising this choice archives the contract after the body is executed. The contract can be used in the body of the exercise.\n+        Contracts created in the choice body are divulged exclusively to the respective signatories and controllers and not to the observers of the contract on which the choice was exercised."
  },
  {
    "id" : "4e392cb4-357e-403f-9e5b-0363cb4f5eaf",
    "prId" : 4134,
    "comments" : [
      {
        "id" : "bb0a950c-9aa1-43ab-983a-8a7754776fe2",
        "parentId" : null,
        "author" : {
          "login" : "bame-da",
          "name" : "Bernhard Elsner",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/40762178?u=28b5edbfe9271d5db3fcfa3b80d30f93cce4321f&v=4"
        },
        "body" : "And here",
        "createdAt" : "2020-01-24T08:35:56Z",
        "updatedAt" : "2020-01-24T15:16:01Z",
        "lastEditedBy" : {
          "login" : "bame-da",
          "name" : "Bernhard Elsner",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/40762178?u=28b5edbfe9271d5db3fcfa3b80d30f93cce4321f&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "1e41fde3-ae67-476c-a957-7de4f80dcbe4",
        "parentId" : "bb0a950c-9aa1-43ab-983a-8a7754776fe2",
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "I'll be very happy to fix them all. I would suggest we do the same in the [blog post](https://blog.daml.com/daml-driven/daml-choice-annotations) that originally made this public.",
        "createdAt" : "2020-01-24T13:11:39Z",
        "updatedAt" : "2020-01-24T15:16:01Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      },
      {
        "id" : "c8d66310-0c31-49f4-ac45-819873575361",
        "parentId" : "bb0a950c-9aa1-43ab-983a-8a7754776fe2",
        "author" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "body" : "Solved in https://github.com/digital-asset/daml/pull/4134/commits/11f52f472e3cb698771d149a1e0d4ac0a464f02a",
        "createdAt" : "2020-01-24T15:19:43Z",
        "updatedAt" : "2020-01-24T15:19:44Z",
        "lastEditedBy" : {
          "login" : "stefanobaghino-da",
          "name" : "Stefano Baghino",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/43749967?v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "11f52f472e3cb698771d149a1e0d4ac0a464f02a",
    "line" : null,
    "diffHunk" : "@@ -90,10 +90,26 @@ Here's the structure of a choice inside a template. There are two ways of specif\n \n     Who can exercise the choice.\n \n-:ref:`consumability <daml-ref-anytime>`\n-    ``nonconsuming`` keyword\n+:ref:`consumability <daml-ref-consumability>`\n \n-    By default, contracts are archived when a choice on them is exercised, which means that choices can no longer be exercised on them. If you include ``nonconsuming``, this choice can be exercised over and over.\n+    At most one of the following:\n+\n+    - ``preconsuming`` keyword\n+\n+        Exercising this choice archives the contract before the body is executed.\n+        Contracts created in the choice body are divulged exclusively to the respective signatories and controllers and not to the observers of the contract on which the choice was exercised.\n+\n+    - ``postconsuming`` keyword\n+\n+        Exercising this choice archives the contract after the body is executed. The contract can be used in the body of the exercise.\n+        Contracts created in the choice body are divulged exclusively to the respective signatories and controllers and not to the observers of the contract on which the choice was exercised.\n+\n+    - ``nonconsuming`` keyword\n+\n+        Exercising this choice will not archive the contract.\n+        Contracts created in the choice body are divulged exclusively to the respective signatories and controllers and not to the observers of the contract on which the choice was exercised."
  },
  {
    "id" : "54f3fbe0-3f6c-40fd-8ecd-a80f0debe453",
    "prId" : 634,
    "comments" : [
      {
        "id" : "1f419782-7f34-427d-8a64-1a2cc0325310",
        "parentId" : null,
        "author" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "body" : "To me this somehow indicates that the return type is always `()`, but it can be anything. How about\r\n```\r\nchoice NameOfChoice : ReturnType controller nameOfParty do\r\n```\r\nIf we do this, we should probably change the summary of the old syntax to\r\n```\r\ncontroller nameOfParty can NameOfChoice : ReturnType do\r\n```\r\nThere's also the option to have choice arguments following the `with` keyword but I guess we don't want that here since we don't have it for the old syntax.",
        "createdAt" : "2019-04-25T13:03:55Z",
        "updatedAt" : "2019-04-25T14:11:23Z",
        "lastEditedBy" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "3ab66c5911e9939ca203964561db2a3cabadc586",
    "line" : null,
    "diffHunk" : "@@ -53,7 +51,11 @@ template body\n         Only create the contract if the conditions after ``ensure`` evaluate to true.\n \n     :ref:`choices <daml-ref-choice-structure>`\n-    \t``controller nameOfParty can nameOfChoice``\n+    \t``controller nameOfParty can nameOfChoice do``\n+\n+        or\n+\n+        ``choice : () controller do``"
  },
  {
    "id" : "d1491c60-f3a0-44cb-a90a-b6902ef85d04",
    "prId" : 634,
    "comments" : [
      {
        "id" : "df3fed82-effc-44c4-9143-3e921d734766",
        "parentId" : null,
        "author" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "body" : "I think the last sentence is slightly misleading. Maybe\r\n> To exercise a choice, the party needs to be a signatory or an observer of the contract and must be explicitly declared as such.",
        "createdAt" : "2019-04-25T13:11:00Z",
        "updatedAt" : "2019-04-25T14:11:23Z",
        "lastEditedBy" : {
          "login" : "hurryabit",
          "name" : "Martin Huschenbett",
          "avatarUrl" : "https://avatars0.githubusercontent.com/u/11665611?u=7dbd00d5e7ea53919ed31dc4200f602ebca91c8f&v=4"
        },
        "tags" : [
          {
            "value" : "outdated"
          }
        ]
      }
    ],
    "commit" : "3ab66c5911e9939ca203964561db2a3cabadc586",
    "line" : null,
    "diffHunk" : "@@ -88,6 +94,8 @@ Here's the structure of a choice inside a template:\n :ref:`choice arguments <daml-ref-choice-arguments>`\n     ``with`` keyword\n \n+    If you start your choice with ``choice`` and include a ``Party`` as a parameter, you can make that ``Party`` the ``controller`` of the choice. This is a feature called \"flexible controllers\", and it means you don't have to specify the controller when you create the contract - you can specify it when you exercise the choice. The ``Party`` still needs to be a parameter to the contract as well, so that they can be added as an observer."
  }
]