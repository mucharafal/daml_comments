[
  {
    "id" : "504e47db-d612-4d53-9a75-59eff0c6b129",
    "prId" : 7205,
    "comments" : [
      {
        "id" : "371dfc7e-fcd2-4e80-95d6-a71b6723de2d",
        "parentId" : null,
        "author" : {
          "login" : "S11001001",
          "name" : "Stephen Compall",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/219186?u=7b27ed58a578fe7d4983d1bab28c2f5608ed8739&v=4"
        },
        "body" : "20:58:59.499 [TriggerService-akka.actor.default-dispatcher-9] INFO  c.d.l.e.trigger.TriggerRunnerImpl - Trigger 61bc6730-fcbe-4613-a93f-ad588906e511 stopped (context: {triggerDefinition=cc176cffd4667d83c42c1cba4402a21a24a05deb7ba6684cd1a7462809de72b1:TestTrigger:trigger, triggerId=61bc6730-fcbe-4613-a93f-ad588906e511})",
        "createdAt" : "2020-09-02T21:05:30Z",
        "updatedAt" : "2020-09-03T15:40:53Z",
        "lastEditedBy" : {
          "login" : "S11001001",
          "name" : "Stephen Compall",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/219186?u=7b27ed58a578fe7d4983d1bab28c2f5608ed8739&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "f5d5af3d7402e279de3eb423f6bf09c7b274c605",
    "line" : 64,
    "diffHunk" : "@@ -1,1 +174,178 @@              // here. It won't receive it (many Bothans died to bring\n              // us this information).\n              logger.info(s\"Trigger $name stopped\")\n              killSwitch.shutdown\n              Behaviors.stopped"
  },
  {
    "id" : "fe62d0d8-2e7e-4b78-bc61-9e3218d3c2a4",
    "prId" : 7205,
    "comments" : [
      {
        "id" : "a24f23ce-df1e-444c-bf3d-6b58cf27b0a9",
        "parentId" : null,
        "author" : {
          "login" : "S11001001",
          "name" : "Stephen Compall",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/219186?u=7b27ed58a578fe7d4983d1bab28c2f5608ed8739&v=4"
        },
        "body" : "20:57:35.926 [TriggerService-akka.actor.default-dispatcher-8] INFO  c.d.l.e.trigger.TriggerRunnerImpl - Trigger 821fb28a-bec4-4047-b4e0-80275157711f is being restarted (context: {triggerDefinition=cc176cffd4667d83c42c1cba4402a21a24a05deb7ba6684cd1a7462809de72b1:TestTrigger:trigger, triggerId=821fb28a-bec4-4047-b4e0-80275157711f})",
        "createdAt" : "2020-09-02T21:06:05Z",
        "updatedAt" : "2020-09-03T15:40:53Z",
        "lastEditedBy" : {
          "login" : "S11001001",
          "name" : "Stephen Compall",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/219186?u=7b27ed58a578fe7d4983d1bab28c2f5608ed8739&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "f5d5af3d7402e279de3eb423f6bf09c7b274c605",
    "line" : 73,
    "diffHunk" : "@@ -1,1 +182,186 @@              // the process of being restarted, will be informed of\n              // the start along the way.\n              logger.info(s\"Trigger $name is being restarted\")\n              Behaviors.same\n          }"
  },
  {
    "id" : "a2817627-215f-42a7-845e-5e97ec159768",
    "prId" : 7205,
    "comments" : [
      {
        "id" : "c5cbfb0c-5d88-44a6-940e-ce3b7eaff250",
        "parentId" : null,
        "author" : {
          "login" : "S11001001",
          "name" : "Stephen Compall",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/219186?u=7b27ed58a578fe7d4983d1bab28c2f5608ed8739&v=4"
        },
        "body" : "20:58:59.462 [TriggerService-akka.actor.default-dispatcher-8] INFO  c.d.l.e.trigger.TriggerRunnerImpl - Trigger 61bc6730-fcbe-4613-a93f-ad588906e511 is starting (context: {triggerDefinition=cc176cffd4667d83c42c1cba4402a21a24a05deb7ba6684cd1a7462809de72b1:TestTrigger:trigger, triggerId=61bc6730-fcbe-4613-a93f-ad588906e511})",
        "createdAt" : "2020-09-02T21:06:31Z",
        "updatedAt" : "2020-09-03T15:40:53Z",
        "lastEditedBy" : {
          "login" : "S11001001",
          "name" : "Stephen Compall",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/219186?u=7b27ed58a578fe7d4983d1bab28c2f5608ed8739&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "f5d5af3d7402e279de3eb423f6bf09c7b274c605",
    "line" : 47,
    "diffHunk" : "@@ -1,1 +60,64 @@      // Report to the server that this trigger is starting.\n      config.server ! TriggerStarting(triggerInstance)\n      logger.info(s\"Trigger $name is starting\")\n      val appId = ApplicationId(name)\n      val clientConfig = LedgerClientConfiguration("
  },
  {
    "id" : "f9349584-98e3-4e49-be38-87c2f8d0df7d",
    "prId" : 6248,
    "comments" : [
      {
        "id" : "84c2d109-b54b-4b5d-aab8-0eb6eb72fe10",
        "parentId" : null,
        "author" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "body" : "Maybe there's an opportunity to refactor here as the behaviour when `wasStopped` is the basically the same for 2/3 messages, i.e. you could check `wasStopped` before the message. Not for this PR though.",
        "createdAt" : "2020-06-05T20:48:19Z",
        "updatedAt" : "2020-06-05T21:07:51Z",
        "lastEditedBy" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "d418228cbcdf661bd90d9677f958b857e988d2ef",
    "line" : 3,
    "diffHunk" : "@@ -1,1 +82,86 @@        Behaviors.receiveMessagePartial[Message] {\n          case QueryACSFailed(cause) =>\n            if (wasStopped) {\n              // The stop endpoint can't send a message to a runner\n              // that isn't in the running triggers table so this is"
  },
  {
    "id" : "deab5fbf-5b55-4e55-82ba-6e03d3bbce3c",
    "prId" : 6079,
    "comments" : [
      {
        "id" : "614effc1-5b4d-4328-ab42-7e53158a51e6",
        "parentId" : null,
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "If I have a token that gives me `readAs` but not `actAs` the trigger will start up successfully but fail as soon as it tries to do anything. A trigger without `actAs` is completely useless so maybe it would make sense to change the logic for detecting that you only have a single party to verify that the party has `actAs`?",
        "createdAt" : "2020-05-25T14:30:54Z",
        "updatedAt" : "2020-05-26T19:55:32Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "33a895a3-3412-431a-b522-50a7745109cf",
        "parentId" : "614effc1-5b4d-4328-ab42-7e53158a51e6",
        "author" : {
          "login" : "shayne-fletcher",
          "name" : "Shayne Fletcher",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/1500167?v=4"
        },
        "body" : "That's a good suggestion. I'll think about that (read, will almost certainly implement that).\r\n\r\nFWIW, the current (expected) behavior is that the actor running the trigger will hit the max retries almost immediately and will be terminated so this idea probably won't add much new except perhaps less resources consumed and maybe better error reporting.",
        "createdAt" : "2020-05-25T14:43:30Z",
        "updatedAt" : "2020-05-26T19:55:32Z",
        "lastEditedBy" : {
          "login" : "shayne-fletcher",
          "name" : "Shayne Fletcher",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/1500167?v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "cbdb87590a19aa1bb81b8b704105db5a774d8efd",
    "line" : 122,
    "diffHunk" : "@@ -1,1 +137,141 @@                  Failed(cause)\n              }\n              // Report to the server that this trigger is entering\n              // the running state.\n              config.server ! TriggerStarted(config.triggerId, config.jwt, parent)"
  },
  {
    "id" : "a2c84c0a-be6f-4cda-8294-5472ae23aa78",
    "prId" : 6079,
    "comments" : [
      {
        "id" : "efe7809b-1a7d-46d8-85a0-e3139380b2c4",
        "parentId" : null,
        "author" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "body" : "Could we send a `Stop` message to the parent TriggerRunner directly here instead of going through the Server? It looks like the Server doesn't do anything besides stop the TriggerRunner, and we have access to the parent here too.",
        "createdAt" : "2020-05-26T16:09:10Z",
        "updatedAt" : "2020-05-26T19:55:32Z",
        "lastEditedBy" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "cbdb87590a19aa1bb81b8b704105db5a774d8efd",
    "line" : 71,
    "diffHunk" : "@@ -1,1 +86,90 @@                config.jwt,\n                parent,\n                cause.toString)\n              // Tell our monitor there's been a failure. The\n              // monitor's supervision strategy will respond to this"
  },
  {
    "id" : "4e24cb9b-702f-4460-9d18-bdad0cb0ab7e",
    "prId" : 6079,
    "comments" : [
      {
        "id" : "873d75b6-f2ab-40e6-9a73-594b068b7fab",
        "parentId" : null,
        "author" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "body" : "Same comment here",
        "createdAt" : "2020-05-26T16:10:55Z",
        "updatedAt" : "2020-05-26T19:55:32Z",
        "lastEditedBy" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "cbdb87590a19aa1bb81b8b704105db5a774d8efd",
    "line" : 84,
    "diffHunk" : "@@ -1,1 +98,102 @@                config.jwt,\n                parent,\n                cause.toString)\n              // Tell our monitor there's been a failure. The\n              // monitor's supervisor strategy will respond to this by"
  },
  {
    "id" : "393342f5-defe-459f-b7e3-73efec9b6fbc",
    "prId" : 6079,
    "comments" : [
      {
        "id" : "04821846-b38b-4fe2-9ce0-bebcb56177d7",
        "parentId" : null,
        "author" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "body" : "The parent will retry this actor until the Server stops the parent, right?",
        "createdAt" : "2020-05-26T16:12:11Z",
        "updatedAt" : "2020-05-26T19:55:32Z",
        "lastEditedBy" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "cbdb87590a19aa1bb81b8b704105db5a774d8efd",
    "line" : 76,
    "diffHunk" : "@@ -1,1 +91,95 @@              // by writing the exception to the log and stopping this\n              // actor.\n              throw new InitializationException(\"User stopped\")\n            } else {\n              // Report the failure to the server."
  },
  {
    "id" : "f6f44bb2-1871-483b-9f07-c4a394c42675",
    "prId" : 6079,
    "comments" : [
      {
        "id" : "6c483a88-fc26-4fc2-89a3-f93bc32eaa00",
        "parentId" : null,
        "author" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "body" : "These two `Failed` cases are where the parent will use the retry strategy (without being stopped by the Server). Is that right?",
        "createdAt" : "2020-05-26T16:14:29Z",
        "updatedAt" : "2020-05-26T19:55:32Z",
        "lastEditedBy" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "1e00feb5-5a08-45ab-b8ae-0be8c925e80e",
        "parentId" : "6c483a88-fc26-4fc2-89a3-f93bc32eaa00",
        "author" : null,
        "body" : "yes",
        "createdAt" : "2020-05-26T16:44:07Z",
        "updatedAt" : "2020-05-26T19:55:32Z",
        "lastEditedBy" : null,
        "tags" : [
        ]
      }
    ],
    "commit" : "cbdb87590a19aa1bb81b8b704105db5a774d8efd",
    "line" : 120,
    "diffHunk" : "@@ -1,1 +135,139 @@                  Failed(new RuntimeException(\"Trigger exited unexpectedly\"))\n                case Failure(cause) =>\n                  Failed(cause)\n              }\n              // Report to the server that this trigger is entering"
  },
  {
    "id" : "c0bf1901-8fb2-44c4-a5d9-fdacc933be12",
    "prId" : 6079,
    "comments" : [
      {
        "id" : "1284aed8-1b43-44b1-aaef-2cc1852f548c",
        "parentId" : null,
        "author" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "body" : "Why do we need to report that we are starting? The server doesn't do anything in that case, but do you expect that to change?",
        "createdAt" : "2020-05-26T16:24:51Z",
        "updatedAt" : "2020-05-26T19:55:32Z",
        "lastEditedBy" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "8a808708-53d9-4b55-afd3-76ee9e0bd89e",
        "parentId" : "1284aed8-1b43-44b1-aaef-2cc1852f548c",
        "author" : null,
        "body" : "yes, i plan to introduce a table tracking changes so that we can report on the status of a trigger",
        "createdAt" : "2020-05-26T16:44:39Z",
        "updatedAt" : "2020-05-26T19:55:32Z",
        "lastEditedBy" : null,
        "tags" : [
        ]
      }
    ],
    "commit" : "cbdb87590a19aa1bb81b8b704105db5a774d8efd",
    "line" : 55,
    "diffHunk" : "@@ -1,1 +64,68 @@      implicit val ec: ExecutionContext = ctx.executionContext\n      // Report to the server that this trigger is starting.\n      config.server ! TriggerStarting(config.triggerId, config.jwt, parent)\n      ctx.log.info(s\"Trigger ${name} is starting\")\n      val appId = ApplicationId(name)"
  },
  {
    "id" : "bc04e0b0-f09d-42c1-830e-f03d24c71bbc",
    "prId" : 5916,
    "comments" : [
      {
        "id" : "170c12de-6d5b-4d74-ad9a-3120528fe4be",
        "parentId" : null,
        "author" : {
          "login" : "shayne-fletcher",
          "name" : "Shayne Fletcher",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/1500167?v=4"
        },
        "body" : "This is new. Previously, `Failed` messages were not handled.",
        "createdAt" : "2020-05-08T17:47:58Z",
        "updatedAt" : "2020-05-08T17:50:49Z",
        "lastEditedBy" : {
          "login" : "shayne-fletcher",
          "name" : "Shayne Fletcher",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/1500167?v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "af232941b942e74dba8060b1a9b12c00425ead19",
    "line" : 101,
    "diffHunk" : "@@ -1,1 +99,103 @@            case Stop =>\n              Behaviors.stopped\n            case Failed(cause) =>\n              // In the event 'runWithACS' completes it's because the\n              // stream is broken. Throw an exception allowing our"
  },
  {
    "id" : "5b312265-8860-4d29-bd94-1ec6fedf07f3",
    "prId" : 5916,
    "comments" : [
      {
        "id" : "6c124361-ebfa-4386-b5b7-3ac4a8684bf4",
        "parentId" : null,
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "Maybe this is an akka-pattern I’m not aware off but I’ve only seen `Impl` be used if you have an abstract interface that you are implementing. This is not what is going on here so it seems rather confusing.",
        "createdAt" : "2020-05-11T07:23:41Z",
        "updatedAt" : "2020-05-11T07:30:19Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "3c3d7a3c-276a-4617-92c3-2a78540f2865",
        "parentId" : "6c124361-ebfa-4386-b5b7-3ac4a8684bf4",
        "author" : {
          "login" : "shayne-fletcher",
          "name" : "Shayne Fletcher",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/1500167?v=4"
        },
        "body" : "Maybe the nomenclature is non-idiomatic for Scala (it's common in C++ e.g. `pImpl`) but at the end of the day, it's nothing more than the classic \"handle-body\" or \"letter-envelope\" pattern.",
        "createdAt" : "2020-05-11T13:02:04Z",
        "updatedAt" : "2020-05-11T13:02:04Z",
        "lastEditedBy" : {
          "login" : "shayne-fletcher",
          "name" : "Shayne Fletcher",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/1500167?v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "af232941b942e74dba8060b1a9b12c00425ead19",
    "line" : 27,
    "diffHunk" : "@@ -1,1 +25,29 @@}\n\nobject TriggerRunnerImpl {\n  case class Config(\n      compiledPackages: CompiledPackages,"
  },
  {
    "id" : "9d3fff71-2429-4caf-b0da-0920d3ba1831",
    "prId" : 5916,
    "comments" : [
      {
        "id" : "475417af-05ae-433c-95cc-9e7d45d05e82",
        "parentId" : null,
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "Can you please try to not shuffle all of this code around in the same PR where you are making actual changes.",
        "createdAt" : "2020-05-11T07:24:11Z",
        "updatedAt" : "2020-05-11T07:30:19Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "8d1934a7-e694-49d3-b5ac-f6e47a0a8541",
        "parentId" : "475417af-05ae-433c-95cc-9e7d45d05e82",
        "author" : {
          "login" : "shayne-fletcher",
          "name" : "Shayne Fletcher",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/1500167?v=4"
        },
        "body" : "That's fair. I'll resist the urge in future and land such things in two parts.",
        "createdAt" : "2020-05-11T13:03:14Z",
        "updatedAt" : "2020-05-11T13:03:14Z",
        "lastEditedBy" : {
          "login" : "shayne-fletcher",
          "name" : "Shayne Fletcher",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/1500167?v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "af232941b942e74dba8060b1a9b12c00425ead19",
    "line" : 1,
    "diffHunk" : "@@ -1,1 +-1,3 @@// Copyright (c) 2020 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.\n// SPDX-License-Identifier: Apache-2.0\n"
  }
]