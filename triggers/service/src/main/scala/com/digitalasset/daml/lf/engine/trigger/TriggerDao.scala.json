[
  {
    "id" : "95e10375-a8f5-4a8d-b6ee-7f06497adacc",
    "prId" : 6279,
    "comments" : [
      {
        "id" : "219ccc5a-3bd8-4d5b-a447-c47cce9278be",
        "parentId" : null,
        "author" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "body" : "As discussed, I'm not sure we can store unencrypted username/password pairs here. Will investigate.",
        "createdAt" : "2020-06-09T19:04:54Z",
        "updatedAt" : "2020-06-10T13:34:38Z",
        "lastEditedBy" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "b59136d8-d24f-4a9b-af6a-44595328b514",
        "parentId" : "219ccc5a-3bd8-4d5b-a447-c47cce9278be",
        "author" : {
          "login" : "shayne-fletcher",
          "name" : "Shayne Fletcher",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/1500167?v=4"
        },
        "body" : "It seems we can use `javax.crytpo` to readily implement encryption. I have functions for doing so on a branch.",
        "createdAt" : "2020-06-09T20:34:41Z",
        "updatedAt" : "2020-06-10T13:34:38Z",
        "lastEditedBy" : {
          "login" : "shayne-fletcher",
          "name" : "Shayne Fletcher",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/1500167?v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "b9464687f8f030036b33ef328663eeb5ef13160c",
    "line" : 13,
    "diffHunk" : "@@ -1,1 +43,47 @@    // Running trigger table.\n    // `trigger_instance` is a UUID generated by the service\n    // `party_token` is the token corresponding to the party\n    // `full_trigger_name` is the identifier for the trigger in its dalf,\n    //  of the form \"packageId:moduleName:triggerName\""
  },
  {
    "id" : "40fc24d3-f18b-4208-9bf3-88e143b7b0ea",
    "prId" : 6279,
    "comments" : [
      {
        "id" : "19c990fd-3f73-4edd-8a33-da21ff715889",
        "parentId" : null,
        "author" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "body" : "This is where the token is used in a query and we need to make sure it's validated. I think we should only use the username here which we could restrict the charset to that of parties.",
        "createdAt" : "2020-06-09T20:16:48Z",
        "updatedAt" : "2020-06-10T13:34:38Z",
        "lastEditedBy" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "8b9efcf8-40f5-4720-8fb8-37164b82bd3b",
        "parentId" : "19c990fd-3f73-4edd-8a33-da21ff715889",
        "author" : {
          "login" : "shayne-fletcher",
          "name" : "Shayne Fletcher",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/1500167?v=4"
        },
        "body" : "as discussed (and more or less resolved above) let's stick with tokens but yes, let us make sure at the point we receive the token that the party identifier meets syntactic requirements.\r\n",
        "createdAt" : "2020-06-09T20:51:13Z",
        "updatedAt" : "2020-06-10T13:34:38Z",
        "lastEditedBy" : {
          "login" : "shayne-fletcher",
          "name" : "Shayne Fletcher",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/1500167?v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "78d231c0-4800-43e2-8cd0-5225630fa944",
        "parentId" : "19c990fd-3f73-4edd-8a33-da21ff715889",
        "author" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "body" : "Yes but also the encrypted token needs to be within a reasonable character set for this query to work.",
        "createdAt" : "2020-06-09T21:31:00Z",
        "updatedAt" : "2020-06-10T13:34:38Z",
        "lastEditedBy" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "16cfd10b-a177-42f4-9f4b-44400baaafb5",
        "parentId" : "19c990fd-3f73-4edd-8a33-da21ff715889",
        "author" : {
          "login" : "shayne-fletcher",
          "name" : "Shayne Fletcher",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/1500167?v=4"
        },
        "body" : "yes. the token stored in the db will be base 64 thus only a-z, A-Z, 0-9, + and / chars.",
        "createdAt" : "2020-06-09T21:56:53Z",
        "updatedAt" : "2020-06-10T13:34:38Z",
        "lastEditedBy" : {
          "login" : "shayne-fletcher",
          "name" : "Shayne Fletcher",
          "avatarUrl" : "https://avatars2.githubusercontent.com/u/1500167?v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "b9464687f8f030036b33ef328663eeb5ef13160c",
    "line" : 35,
    "diffHunk" : "@@ -1,1 +103,107 @@    val partyToken = credentials.token\n    val select = Fragment.const(\"select trigger_instance from running_triggers\")\n    val where = Fragment.const(s\" where party_token = '${partyToken}'\")\n    val order = Fragment.const(\" order by running_triggers\")\n    val list = select ++ where ++ order"
  },
  {
    "id" : "453ad781-3fe1-4986-a688-7b851ef4bf26",
    "prId" : 6153,
    "comments" : [
      {
        "id" : "aed69a0a-4694-458a-abdf-650183d09649",
        "parentId" : null,
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "Please document the format of the name if you want to store it as a single string.",
        "createdAt" : "2020-06-02T07:25:19Z",
        "updatedAt" : "2020-06-02T16:34:36Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "73082145-e772-4036-b454-14412e99d2ef",
        "parentId" : "aed69a0a-4694-458a-abdf-650183d09649",
        "author" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "body" : "Do you just mean a comment in this code or somewhere else?",
        "createdAt" : "2020-06-02T15:57:23Z",
        "updatedAt" : "2020-06-02T16:34:36Z",
        "lastEditedBy" : {
          "login" : "rohanjr",
          "name" : "Rohan Jacob-Rao",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/10836630?u=a30da7f2a9ceeb7c25249d5146f10fce61aeec4e&v=4"
        },
        "tags" : [
        ]
      },
      {
        "id" : "10876b80-7346-4dd7-88a6-17561b7dc5e6",
        "parentId" : "aed69a0a-4694-458a-abdf-650183d09649",
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "Just here in the code is totally fine.",
        "createdAt" : "2020-06-02T15:59:18Z",
        "updatedAt" : "2020-06-02T16:34:36Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "2e27d8a43e27c8fcdaccc26c506fee4f3359edba",
    "line" : 33,
    "diffHunk" : "@@ -1,1 +51,55 @@          trigger_instance uuid primary key,\n          party_token text not null,\n          full_trigger_name text not null\n        )\n      \"\"\""
  },
  {
    "id" : "b281db61-c7de-4126-8863-ad7a69abeb66",
    "prId" : 6062,
    "comments" : [
      {
        "id" : "2baed266-3a0b-4f8e-a96d-9c6a952b7879",
        "parentId" : null,
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "presumably this is not just the name but `package_id:module_name:trigger_name`. If you store them separately you save yourself from having to parse it everytime you read it from the DB. Either way, we should document what we store here.",
        "createdAt" : "2020-05-21T06:44:04Z",
        "updatedAt" : "2020-05-21T22:33:56Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "30baa950bdb2fc1851cd1b480587cacb471b9a2f",
    "line" : 49,
    "diffHunk" : "@@ -1,1 +47,51 @@          package_id text not null,\n          module_name text not null,\n          trigger_name text not null\n        )\n      \"\"\""
  },
  {
    "id" : "47e04440-737c-4fb2-aee8-960089bca2d6",
    "prId" : 6062,
    "comments" : [
      {
        "id" : "b24d6b20-464b-401a-abd8-de593745426b",
        "parentId" : null,
        "author" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "body" : "Your table is called `dar_packages` but one DAR has multiple dalfs and therefore package ids. I think you mean `dalf_packages` or just `dalfs`.",
        "createdAt" : "2020-05-21T06:44:36Z",
        "updatedAt" : "2020-05-21T22:33:56Z",
        "lastEditedBy" : {
          "login" : "cocreature",
          "name" : "Moritz Kiefer",
          "avatarUrl" : "https://avatars1.githubusercontent.com/u/1313584?u=7864421488a876940b33e865c4b0091925617ca7&v=4"
        },
        "tags" : [
        ]
      }
    ],
    "commit" : "30baa950bdb2fc1851cd1b480587cacb471b9a2f",
    "line" : 54,
    "diffHunk" : "@@ -1,1 +52,56 @@    val createDalfTable: Fragment = sql\"\"\"\n        create table dalfs(\n          package_id text primary key,\n          package bytea not null\n        )"
  }
]